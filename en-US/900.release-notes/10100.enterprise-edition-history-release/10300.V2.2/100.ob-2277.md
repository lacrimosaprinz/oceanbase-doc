|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||

# OceanBase Database Enterprise Edition V2.2.77

## V2.2.77 BP17

### Version information

* Release date: May 19, 2023
* Version: V2.2.77 BP17
* RPM version: oceanbase-2.2.77-117000112023051914

### Enhanced features

Security enhancement: The `_enable_reserved_user_dcl_restriction` parameter is provided to control whether general users can modify built-in users.

### Parameter changes

| Parameter | Change type | Default value | Description |
| ----- | ----- | ----- | ----- |
| _enable_reserved_user_dcl_restriction | New | false | Specifies whether built-in users can be modified only by built-in users. This is a cluster-level parameter. Valid values: `true` and `false`.[]  |

### Behavioral changes

* The initial value of the `time_zone` system variable is changed from `+8:00` to `+08:00`.
* The `SELECT` statements cannot be sent in PS mode. In an earlier version, `SELECT` statements can be sent, but 0 rows are returned.

### Bug fixes

* Fixed an issue that when the index key of an index table contains a NULL value, which is contained in the extracted query range of the SQL query, the query result may be incorrect.
* Fixed an issue that the asynchronous refresh of the location cache may fail due to the leader switchover of the `__all_core_table` or `__all_root_table` table. This causes SQL execution to time out.
* Fixed an issue that when a HASH JOIN operator appears in the right branch of a SUBPLAN FILTER or NESTED-LOOP JOIN operator, and the left branch contains a large number of rows, SQL execution takes a long time and consumes a large amount of memory space.
* Fixed an issue that if the view in an SQL query is the same as that in its subquery, and the predicates are pushed down to a wrong view, the query result set may be inconsistent with that of an Oracle database.
* Fixed an issue that if you use a constructor as the default value of a composite data type in the PL package, the SYS500 tenant consumes a large amount of memory space.
* Fixed an issue that if the PL package does not exit and the trigger is called multiple times, the memory usage continues to increase.
* Fixed an issue that a memory leak is caused by a cursor.
* Fixed an issue that the major compaction of a standby cluster times out.
* Fixed an issue that cache miss occurs and the execution of `INSERT` statements is slow when the `not_param` identifier of the system is incorrectly set.
* Fixed an issue that if a `PACKAGE` variable is used as the output parameter for internal calls in Oracle mode, the execution results of stored procedures are incompatible with that of an Oracle database.
* Fixed an issue that after a predicate is pushed down, the execution result is not as expected due to abnormal return results of the expression.
* Fixed an issue that a memory leak occurs when a `SELECT` statement is parsed in an `INSERT ALL` statement.
* Fixed an issue that if the `ob_tcp_invited_nodes` variable contains a subnet mask, an error occurs during the matching of IP addresses against the allowlist.
* Fixed an issue that if a node is killed by running the `kill -9` command, but the server is not added to the session blocklist, the backup and restore job fails.
* Fixed an issue that if the deduction of the IN predicate is performed again when an IN predicate already exists in the table, a large query range is extracted and an error is returned during SQL execution.
* Fixed an issue that if the package called contains synonyms, the compilation of the caller package fails.
* Fixed an issue that the execution of a unit migration task is slow in a standby cluster.
* Fixed an issue that if you specify an alias for a synonym view, an error is returned when you access the synonym view.
* Fixed an issue that if you use an analytic function (also known as a window function) expression as the input parameter of a user-defined function (UDF), the 4016 error is returned.
* Fixed an issue that some indexes are abnormal after a successful physical restore.
* Fixed an issue that an error is returned during the execution of the `REGEXP_REPLACE` expression due to multiple implicit conversions of unmatching field types.
* Fixed an issue that the content read from read-only views cannot be written to other tables.
* Fixed an issue that the value of storage space occupied by backup files is inaccurate in the system table.
* Fixed an issue that in PS mode, the prefix index is parsed based on the LIKE expression without verifying whether the LIKE pattern meets the constraint, which causes an error during the execution of stored procedures.
* Fixed an issue that after an upgrade, if the `ANALYZE` statement is used against a table of an earlier version, an error is returned.

### Upgrade and limitations

* The primary and standby clusters can be upgraded only in maximum performance mode. If a cluster is in maximum protection mode or maximum availability mode, you must switch the cluster to maximum performance mode before you can upgrade the cluster.
* PL debugging is supported only for x86 platforms. We recommend that you do not use this feature on an ARM platform.
* If you enable the dynamic AccessKey ID (AK)/AccessKey secret (SK) setting feature for data backup and restore, you cannot upgrade OceanBase Database to V3.x.

## V2.2.77 BP16

### Version information

* Release date: February 14, 2023
* Version: V2.2.77 BP16
* RPM version: oceanbase-2.2.77-116000022023021412

### Enhanced features

The GROUP COMMIT capability is supported for OBKV to update hotspot rows. To better handle highly concurrent updates of hotspot rows, the server that supports GROUP COMMIT aggregates concurrent updates to prevent repeated row lock application and release for each operation. This saves the wait time due to row lock contention, and speeds up the hotspot row update. 

### Bug fixes

* Fixed an issue that the execution of the `USE DATABASE` statement triggers implicit commit of transactions.
* Fixed an issue that the `SELECT` statement in PL cannot read the data that has not been committed.
* Fixed an issue that some indexes are abnormal after a successful physical restore.
* Fixed an issue that when you create a view, you must also specify an alias for `ROWID` in the `SELECT` clause even if you have specified column names.
* Fixed an issue that the `BATCH GET` request of HBaseAPI takes a long time to complete.
* Fixed an issue that the update of a primary key column in a TableAPI operation results in data inconsistency between the primary table and the index table.
* Fixed an issue that an error is returned when TableAPI automatically updates fields with default values of `CURRENT_TIMESTAMP` or `ON UPDATE CURRENT_TIMESTAMP`.
* Fixed an issue that an error is returned when the estimated result length of the `REGEXP_REPLACE` function is greater than the maximum allowable value because of excessively strict program check.
* Fixed an issue that the binary comparison of the `FIND_IN_SET(binary 'b','a,B,c,d')` function does not take effect in MySQL mode.
* Fixed an issue that the execution of the `FIND_IN_SET` function is slow in MySQL mode.
* Fixed an issue that the `backup_piece` files that are expected to be cleaned up are not deleted in a normally scheduled automatic cleanup task.

### Upgrade and limitations

* The primary and standby clusters can be upgraded only in maximum performance mode. If a cluster is in maximum protection mode or maximum availability mode, you must switch the cluster to maximum performance mode before you can upgrade the cluster.
* If you have enabled the dynamic AccessKey ID (AK)/AccessKey secret (SK) setting feature for data backup and restore, you cannot upgrade OceanBase Database to V3.x. 
* PL debugging is supported only for x86 platforms. We recommend that you do not use this feature on an ARM platform. 

## V2.2.77 BP15

### Version information

* Release date: January 10, 2023
* Version: V2.2.77 BP15
* RPM version: oceanbase-2.2.77-115000012023010607

### Enhanced features

The `FROM_BASE64()` and `TO_BASE64()` functions are supported in MySQL mode. 

### Compatibility changes

In MySQL mode, the `ORDER BY` or `LIMIT` operator cannot be used for multi-table updates, which is consistent with MySQL. 

### Bug fixes

* Fixed an issue that when you use an IN expression to query a partitioned table, the calculated result set is incorrect.
* Fixed an issue that the migration of an empty resource unit causes the leader to get stuck.
* Fixed an issue that when an execution plan hits the plan cache, the execution result of `MERGE INTO` is incorrect.
* Fixed an issue that a memory leak occurs when indexes are created on JSON generated columns.
* Fixed an issue that backup sets fail to be cleared during automatic backup clearing.
* Fixed an issue that in Oracle mode, when a package uses a cursor for loop operations, Error 4179 is returned.
* Fixed an issue that the standby database fails to restart due to an slog replay error.
* Fixed an issue that errors are returned when the LPAD function processes special characters whose ASCII codes are 0x03, 0x04, 0x05, and 0x06.
* Fixed an issue that during the clearing of expired backups, the clearing task remains in the DOING state and cannot be stopped.
* Fixed an issue that if the execution of a transaction is interrupted, the transaction ID recorded in SQL audit logs is incorrect.

### Upgrade and limitations

* The primary and standby clusters can be upgraded only in maximum performance mode. If a cluster is in maximum protection mode or maximum availability mode, you must switch the cluster to maximum performance mode before you can upgrade the cluster.
* PL debugging is supported only for x86 platforms. We recommend that you do not use this feature on an ARM platform. 
* If you have enabled the dynamic AccessKey ID/AccessKey Secret setting feature for data backup and restore, an upgrade to V3.x is not supported. 

## V2.2.77 BP14

### Version information

* Release date: December 04, 2022
* Version: V2.2.77 BP14
* RPM version: oceanbase-2.2.77-114000072022120410

### Enhanced features

* You can change the AccessKey ID and AccessKey Secret during data backup and restore. The backup feature of OceanBase Database allows you to specify an Alibaba Cloud Object Storage Service (OSS), Tencent Cloud Object Storage (COS), or Huawei Object Storage Service (OBS) bucket as the backup destination. However, you cannot modify the `access_id` or `access_key` parameter of the backup destination during the backup. If the AccessKey ID or AccessKey Secret is changed, you must stop the log backup and change the backup directory.  Therefore, this version provides the `ALTER SYSTEM change external_storage_dest PATH[=]'xxx?host=xxx'  set  ACCESS_INFO[=]'access_id=xxx&access_key=xxx';` command for you to modify the AccessKey ID and AccessKey Secret of the backup destination. The relevant content in GConf is updated and saved accordingly. Observe the following considerations when you use this command:

   * Before you run the command to update the AccessKey ID and AccessKey Secret for accessing the OSS, COS, or OBS bucket, we recommend that you stop the ongoing second backup task. We also recommend that you delete the old AccessKey ID and AccessKey Secret one hour later after you run the command. 
   * If you modify the AccessKey ID and AccessKey Secret during a second backup task, and the task is stuck, you must forcibly cancel the task and change the directory to resume the task. 

* The following three fields are added to the `v$sysstat` view to optimize hotspot row observation.
   * `TRANS_ELR_ENABLE_COUNT`: the number of transactions for which early lock release (ELR) can be enabled. 
   * `TRANS_ELR_UNABLE_COUNT`: the number of transactions for which ELR is disabled. 
   * `READ_ELR_ROW_COUNT`: the number of rows that support ELR. The number of rows that support ELR is increased. 

* `ob_admin` supports OBS. 

### Bug fixes

* Fixed an issue that the execution of the `to_hex()` function during stored procedure debugging causes server failures.
* Fixed an issue that when system variables fail to be loaded, the session is abnormally released, and this causes a server failure.
* Fixed an issue that the time zone used by the backup logic is different from that used by the restore logic. As a result, the default values of restored table fields lag behind those of the original table by 8 hours.
* Fixed an issue that when the `_enable_fulltext_index` parameter is set to `OFF`, creating a full-text index succeeds, which is abnormal.
* Fixed an issue that when the special characters "+/" are used in a `LIKE` statement, the query result of an index scan is incorrect.
* Fixed an issue that when an inner join subquery is executed, the query results in OceanBase Database and MySQL Database are inconsistent.
* Fixed an issue that in an outer join, the number of rewritten rows is inconsistent with the number of queried rows.
* Fixed an issue that the number of constraints on the `CONCAT()` function is negative, which is abnormal.
* Fixed an issue that when the batch deletion operation of COS is called, the system cannot determine whether all objects are deleted.
* Fixed an issue that when you delete a large number of `Fail to erase key from cache` entries from the `observer.log` file, an error is returned.
* Fixed an issue that in non-strict mode, the execution result of creating an index is different from that of adding an index.
* Fixed an issue that the `use_hash_aggregation` hint does not take effect.
* Fixed an issue that after schema history file recycling is enabled, physical restore may fail.
* Fixed an issue that the backup may fail due to an incorrect session count in the independent backup and restore subprocess.
* Fixed an issue that during the procedural language (PL) execution by using the `OCI_BATCH_ERRORS` handle, a data storage error occurs due to primary key conflicts.
* Fixed an issue that if slogs and SSTables are located on the same disk, the `clog disk is almost full` error is returned during slog initialization.

### Upgrade and limitations

* The primary and standby clusters can be upgraded only in maximum performance mode. If a cluster is in maximum protection mode or maximum availability mode, you must switch the cluster to maximum performance mode before you can upgrade the cluster.
* PL debugging is supported only for x86 platforms. We recommend that you do not use this feature on an ARM platform. 
* If you have enabled the dynamic AccessKey ID/AccessKey Secret setting feature for data backup and restore, an upgrade to V3.x is not supported. 

## V2.2.77 BP13


### Version information

* Release date: August 26, 2022

* Version: V2.2.77 BP13
  
* RPM version: oceanbase-2.2.77-113000052022082622

### Enhanced features

* Adding partitions is supported in specific scenarios. You can add partitions at the beginning or in the middle of RANGE-partitioned tables. When you add a partition, make sure that no data is written to this partition. You can enable this feature by using the tenant-level parameter `_enable_add_between_range_partitions`.
* Cluster-level parameters of a specific OBServer can be modified by using `ob_admin`. However, tenant-level parameters cannot be modified for a specific OBServer.
* Backup files on Tencent Cloud COS can be tagged to facilitate file management.
### Bug fixes

* Fixed an issue that the cluster restart times out due to an excessive number of schema history records.
* Fixed an issue that in MySQL mode, an error is returned for invalid characters generated during the conversion of the GBK character set by calling the `CONVERT()` function. In this version, the invalid characters are converted to 0x3F, which is compatible with MySQL.
* Fixed an issue that in the primary-standby deployment mode, records in the virtual table `__all_server_event_history` expand fast due to frequent execution of the `ALTER SYSTEM CHANGE TENANT` operation on the primary database.
* Fixed an issue that during the execution of a distributed plan, when one OBServer node fails, the execution of SQL statements on other OBServer nodes hangs until timeout.
* Fixed an issue that when an equivalent condition is used to detect the case sensitivity of the collation, the returned result set is wrong because an execution plan is incorrectly hit.
* Fixed an issue that when a backup task is forcibly canceled, the backup status stays in `Stopping`.
* Fixed an issue that when the `INSERT...ON DUPLICATE KEY UPDATE` statement is executed, an error indicating duplicated primary keys is returned.
* Fixed an issue that an error is returned during the execution of a nested aggregate operator that contains `Distinct`.
* Fixed an issue that invalid log information about RPC communication between OBServer nodes is deleted.
* Fixed an issue that when the `__min_full_resource_pool_memory` parameter is set to an abnormal value, the OBServer node can still be started.
* Fixed an issue that when the `LAST_INSERT_ID()` function is called within a stored procedure, a invalid execution result is generated.
* Fixed an issue that the 4016 error is returned when a partition is truncated.
* Fixed an issue that an error occurs for the data of the `net_wait_time` field in the `gv$sql_audit` view.
* Fixed an issue that when the `weak_read_version_refresh_interval` parameter is set to `0`, the data in partitions is not synchronized.
* Fixed an issue that the query timeout hint added to the cursor of a stored procedure does not take effect.
* Fixed an issue that in Oracle mode, when a prepared statement is enabled, the return value of the `NUMTODSINTERVAL()` function is truncated to a specific precision.
* Fixed an issue that after a partition is dropped or truncated, the locality change is suspended due to duplicate global indexes.

### Upgrade and limitations

* The primary and standby clusters can be upgraded only in maximum performance mode. If a cluster is in maximum protection mode or maximum availability mode, you must switch the cluster to maximum performance mode before you can upgrade the cluster.
* PL debugging is supported only for x86 platforms. We recommend that you do not use this feature on an ARM platform.

## V2.2.77 BP12


### Version information

* Release date: June 14, 2022

* Version: V2.2.77 BP12
  
* RPM version: oceanbase-2.2.77-20220612090508

### Bug fixes

* Fixed an issue that in Oracle mode, when you create a stored procedure with the specified character set GBK, the OBServer node becomes suspended unexpectedly in the SQL prepare phase.
* Fixed an issue that in MySQL mode, an error is returned because the Limit operator does not support character type conversion.
* Fixed an issue that when the system performs a follower-to-leader switchover during a major compaction, the SQL statement is rolled back because the cached route is inaccurate. This causes a long execution time.
* Fixed an issue that Error 4007 is returned when the `DBMS_LOB.SUBSTR` system package is executed in Oracle mode.
* Fixed an issue that the `queue_time` field is displayed as a negative value in the `v$sql_audit` view.
* Fixed an issue that in the `sys` tenant, the resource specifications are not restored to the default settings after a unit is removed.
* Fixed an issue that when the input parameter is converted during the execution of a stored procedure, the following error is returned: `value too large for column`.
* Fixed an issue that in multi-table join queries, the CPU utilization is high when the join key has an index and a `ROWNUM` or `LIMIT` operator.
* Fixed an issue that when a null condition is used to query the `INFORMATION_SCHEMA.COLUMNS` view, incorrect results are returned.
* Fixed an issue that the observer process unexpectedly exits due to an exception occurring in table access by global index primary key. This is caused because the background thread does not initialize the tenant context.
* Fixed an issue that the observer process unexpectedly exits because the cluster is stopped while data is written to Tencent Cloud Object Storage (COS) or Alibaba Cloud Object Storage Service (OSS).
* Fixed an issue that a syntax error is returned when the `DBMS_LOB` system package is executed to insert data.
* Fixed an issue that the logs of the RootService node repeatedly report errors because an exception occurs when an index is created.

### Upgrade and limitations

* The primary and standby clusters can be upgraded only in maximum performance mode. If a cluster is in maximum protection mode or maximum availability mode, you must switch the cluster to maximum performance mode before you can upgrade the cluster.
* PL debugging is supported only for x86 platforms. We recommend that you do not use this feature on an ARM platform.

## V2.2.77 BP11


### Version information

* Release date: May 2, 2022

* Version: V2.2.77 BP11

* RPM version: oceanbase-2.2.77-20220502140811

### Enhanced features

* The integration of the transparent data encryption (`TDE`) feature with the Alibaba Cloud Key Management Service (KMS) system is supported.

* The performance of non-blocking Table API queries is improved.

* The maximum value of the `in(values)` query is optimized to make it compatible with MySQL.

* Filtering by tenant is supported by `liboblog` to synchronize only logs of the specified tenants.

* Returning the synchronization timestamps of logs is supported by `liboblog`.

### Bug fixes

* Fixed an issue that in MySQL mode, an error is returned during the parsing of the `GROUP BY expression` because of unclear semantics. In this version, the `expression` from the selection list is used to avoid errors.

* Fixed an issue that in MySQL mode, an error is returned for invalid characters generated during the conversion of the `GBK` character set by calling the `CONVERT()` function. In this version, the invalid characters are converted to `0x3F`, which is compatible with MySQL.

### Upgrade and limitations

* The primary and standby clusters can be upgraded only in maximum performance mode. If a cluster is in maximum protection mode or maximum availability mode, you must switch the cluster to maximum performance mode before you can upgrade the cluster.

* PL debugging is supported only for x86 platforms. We recommend that you do not use this feature on an ARM platform.

## V2.2.77 BP10

### Version information

* Release date: January 17, 2022

* Version: V2.2.77 BP10

* RPM version: oceanbase-2.2.77-20220116224111

### Enhanced features

* The tag cleanup mode is supported in OSS.

* The `USERENV('SID')` and `USERENV('LANGUAGE')` functions are supported in Oracle mode.

* When the backup space reaches 100%, you can delete obsolete backup files.

* The stability and performance of the queuing table are improved.

* The streaming compression algorithm, which is not supported for clog compression, is removed.

* The `4 KB` aligned writes of disk `DIRECT_IO` are supported.

### Compatibility changes

* By default, the `auto_refresh_location_cache` parameter is set to true to enable the balance strategy for partition replicas.

* By default, the `schema_history_recycle_interval` parameter is set to true to enable the periodic cleanup of expiry records in the system table by background threads.

### Bug fixes

* Fixed an issue that the column type in the view of null columns is `NULL`, but that in the Oracle database is `char(0)`.

* Fixed an issue that in the `gv$sql_audit` view, the maximum length of the `QUERY_SQL` column is not `64 KB`.

* Fixed an issue that in Oracle mode, a false positive error is returned, which indicates that the total row length of all columns exceeds the value of the `OB_MAX_USER_ROW_LENGTH` parameter.

* Fixed an issue that the index creation fails when the GBK character set is used.

* Fixed an issue that the statistics of a tenant recovered by using the backup and restore feature are not promptly updated.

* Fixed an issue that the error `not support` is returned when you set the `secure_file_priv` parameter after the connection is created by using the IP address `127.0.0.1`.

* Fixed an issue that an error is returned for incorrect calculation of string length when the `CREATE TABLE` statement involves the setting of `variable` values.

* Fixed an issue that the error `Column length too big for column` is returned during the length check of the `LOB` columns.

* Fixed an issue that an error is returned during the execution of the `ALTER TABLE DROP COLUMN` statement due to the delayed deletion of physical backups.

* Fixed an issue that when the `sql_auto_is_null` parameter is set to ON, the error `Invalid Argument` is returned during a query where the auto-increment columns need to be identified.

* Fixed an issue that in Oracle mode, no privilege is provided to control the `TRUNCATE DLL` operation.

* Fixed an issue that the creation of a global index fails if the process of an OBServer node exits.

* Fixed an issue that the `__all_virtual_memory_info` table displays incomplete tenant information.

* Fixed an issue that the `try_cnt` column of the `gv$sql_audit` view shows inaccurate statistics.

* Fixed an issue that in Oracle mode, the `TO_CHAR()` function cannot recognize the date format.

* Fixed an issue that an error occurs when checking is conducted for the index created on a column of the `CHAR` type in Oracle mode.

* Fixed an issue that all rows are `NULL` after the `LEFT JOIN UPDATE` on multiple tables.

* Fixed an issue that in PL mode, the observer process unexpectedly exits due to the existence of the `PRINT LOB` data type.

* Fixed an issue that the observer process unexpectedly exits because the `LIKE` clause in the SQL statement exceeds `250 KB` in length.

### Upgrade and limitations

* The primary and standby clusters can be upgraded only in maximum performance mode. If a cluster is in maximum protection mode or maximum availability mode, you must switch the cluster to maximum performance mode before you can upgrade the cluster.

* PL debugging is supported only for x86 platforms. We recommend that you do not use this feature on an ARM platform.

## V2.2.77 BP9

### Version information

* Release date: November 19, 2021

* Version: V2.2.77 BP9
  
* RPM version: oceanbase-2.2.77-20211119120733

### Bug fixes

* Fixed an issue that the `4038` error is returned at the `close` phase of parallel execution.

* Fixed an issue that when PL debugging is performed in the OceanBase Developer Center (ODC) console, resources for debugging cannot be quickly released if ODC directly exits.

* Fixed an issue that the client session is disconnected when the memory request fails at the `SQL PARSE` phase.

* Fixed an issue that when a temporary table is created and added with constraints, the cluster is hung if a constraint of the temporary table has the same name as that of a non-temporary table.

* Fixed an issue that the `MERGE INTO (SELECT *)` statement is incompatible with Oracle.

* Fixed an issue that in Oracle mode, the `ALL_TAB_PARTITIONS` view displays partitions in an unordered way.

* Fixed an issue that the `4016` error is returned during the execution of the `REPLACE INTO` statement.

* Fixed an issue that the `gv$sql_audit` view displays inaccurate `QUEUE_TIME` and `RETRY_CNT` statistics.

* Fixed an issue that the incorrect `FILE HANDLE` is obtained when the NFSv4 protocol is used for backup.

* Fixed an issue that the `gv$sql_audit` view displays the password for user creation in plaintext.

* Fixed an issue that if the base table of the `gv$sql_audit` view does not exist, the value of `elapsed_time` in the recorded query information is 0.

* Fixed an issue that in Oracle mode, the `pivot` and `unpivot` clauses are incompatible with Oracle.

* Fixed an issue that the restart of the observer process keeps failing because it cannot be replayed after the restart, which is caused by the reuse of old slogs due to insufficient storage space.

* Fixed an issue that when the `SHOW TABLE STATUS` statement is executed to query a partitioned table, the result is NULL.

* Fixed an issue that in Oracle mode, the error `unknown timezone` is returned for the OBClient connection after you specify the `global time_zone` system variable.

* Fixed an issue that in MySQL mode, the user privileges on a table remain valid after the table is deleted.

* Fixed an issue that some IP addresses in the `gv$sql_audit` view are parsed into `0.0.0.0`.

* Fixed an issue that in Oracle mode, an error is returned when the `SELECT * FROM (GENERATED TABLE)` statement is executed due to duplicate column names.

* Fixed an issue that the `BIT` data type is incompatible with MySQL.

* Fixed an issue that the observer process unexpectedly exits when it reads the configuration file during startup.

* Fixed an issue that the observer process unexpectedly exits during the data backup to OSS.

* Fixed an issue that the observer process unexpectedly exits during the conversion of the `SET/ENUM/LOB` data types.

### Upgrade and limitations

* The primary and standby clusters can be upgraded only in maximum performance mode. If a cluster is in maximum protection mode or maximum availability mode, you must switch the cluster to maximum performance mode before you can upgrade the cluster.

* PL debugging is supported only for x86 platforms. We recommend that you do not use this feature on an ARM platform.

## V2.2.77 BP8

### Version information

* Release date: October 15, 2021

* Version: V2.2.77 BP8
  
* RPM version: oceanbase-2.2.77-20211117180427

### Enhanced features

The internal `__ALL_VIRTUAL_PROCESSLIST` table is provided to display the transaction timeout status.

### Bug fixes

* Fixed an issue that in the parallel SQL execution framework, the `SELECT FOR UPDATE` statement causes the optimizer to return the `OB_STATE_NOT_MATCH` error.

* Fixed an issue that the `gv$SQL_PLAN_MONITOR` view cannot properly display non-distributed plans.

* Fixed an issue that an internal error is returned when the `NVL()` function is used in the `CASE WHEN` statement.

* Fixed an issue that in Oracle mode, the value of the `PARTITION KEY COUNT` field in the `ALL_PART_TABLES` table is not displayed.

* Fixed an issue that the tenant restore operation fails when the tenant is deleted.

* Fixed an issue that in MySQL mode, the execution of the `SET PASSWORD` statement in stored procedures does not take effect.

* Fixed an issue that the creation of `views` in PL fails in MySQL mode.

* Fixed an issue that the `redo_transport_option` parameter of the standby cluster does not take effect.

* Fixed an issue that the observer process unexpectedly exits during the conversion from the `INT and STRING` data types to the `DATATIME, DATE, and TIME` data types.

* Fixed an issue that the observer process unexpectedly exits during the process of setting the `PARALLEL_MAX_SERVERS` variable.

* Fixed an issue that in Oracle mode, the use of `TRIGGER` causes the `SQL EXECUTOR` module to have memory leaks.

* Fixed an issue that Error `4019` is returned when you create a tenant after a large number of tenants are deleted.

* Fixed an issue that the observer process unexpectedly exits during the process of setting the `clog_disk_usage_limit_percentage` and `clog_disk_utilization_threshold` parameters.

### Upgrade and limitations

* The primary and standby clusters can be upgraded only in maximum performance mode. If a cluster is in maximum protection mode or maximum availability mode, you must switch the cluster to maximum performance mode before you can upgrade the cluster.

* PL debugging is supported only for x86 platforms. We recommend that you do not use this feature on an ARM platform.

## V2.2.77 BP7

### Version information

* Release date: September 18, 2021

* Version: V2.2.77 BP7

* RPM version: oceanbase-2.2.77-20210923214552

### Enhanced features

* The eviction mechanism of SQL execution plans for partitioned tables is optimized.

* Secure Sockets Layer (SSL) communication encryption is supported by `ob_admin`.

* The `LOAD DATA REPLACE` syntax is supported in Oracle mode.

* The user logon and logoff statistics are collected.

* The `ORDER BY` expression is supported in MySQL mode.

* Automatic load balancing for partitions in a `STOP SERVER/ZONE` operation is optimized.

* The routing of temporary tables is optimized.

### Bug fixes

* Fixed an issue that the creation of a tenant fails if the `_enanble_easy_keepalive` parameter is set to true.

* Fixed an issue that the `substr(c1,x,1)='a'` query cannot hit the plan cache.

* Fixed an issue that the logical restore fails because the `rowkey` does not meet the length requirements.

* Fixed an issue that the accumulation of clogs causes the OBServer node to restart, which results in excessive memory consumption by the `sys` tenant.

### Upgrade and limitations

* The primary and standby clusters can be upgraded only in maximum performance mode. If a cluster is in maximum protection mode or maximum availability mode, you must switch the cluster to maximum performance mode before you can upgrade the cluster.

* PL debugging is supported only for x86 platforms. We recommend that you do not use this feature on an ARM platform.

## V2.2.77 BP6

### Version information

* Release date: August 25, 2021

* Version: V2.2.77 BP6
  
* RPM version: oceanbase-2.2.77-20210825181323

### Bug fixes

* Fixed an issue that the backup set is marked as Deleted after the secondary backup fails.

* Fixed an issue that in a scenario where a tenant restore operation is performed, if an existing tenant has the same name as the tenant to be recovered, the existing tenant is dropped.

* Fixed an issue that in a parallel execution (PX), if a long timeout is set for a tenant by default, the operation of session termination takes a long time to respond.

* Fixed an issue that the observer process may fail to start with a small probability after clog compression is enabled.

* Fixed an issue that deadlocks are possible when `SECURITY AUDIT` is enabled in high concurrency scenarios.

* Fixed an issue that the observer process unexpectedly exits in Oracle mode because of the execution of the `SELECT FETCH UNION SELECT FETCH` syntax.

* Fixed an issue that the observer process unexpectedly exits when the memory request fails during the execution of a distributed plan.

### Upgrade and limitations

* The primary and standby clusters can be upgraded only in maximum performance mode. If a cluster is in maximum protection mode or maximum availability mode, you must switch the cluster to maximum performance mode before you can upgrade the cluster.

* PL debugging is supported only for x86 platforms. We recommend that you do not use this feature on an ARM platform.

## V2.2.77 BP5

### Version information

* Release date: July 31, 2021

* Version: V2.2.77 BP5
  
* RPM version: oceanbase-2.2.77-20210730214129

### Enhanced features

You can set the `SQL_MODE` parameter to `NO_ZERO_IN_DATE` in MySQL mode.

### Compatibility changes

The following default actions of the `SQL_MODE` parameter are changed in MySQL mode:

* In earlier versions, the `STR_TO_DATE('202102', '%Y%m')` function returns NULL.
* In this version, the `STR_TO_DATE('202102', '%Y%m')` function returns 2021-01-31.
* To roll back the default actions in earlier versions, manually set the `sql_mode` parameter. For example, set `sql_mode = concat(@@sql_mode, ',NO_ZERO_IN_DATE')`.

### Bug fixes

* Fixed an issue that the observer process unexpectedly exits when an excessive number of columns are operated by the `TRIGGER`.

* Fixed an issue that the query on the generated column in conjunction with the `ORDER BY LIMIT` action generates an incorrect plan.

* Fixed an issue that incorrect results are generated because no deep copy is performed during a `BATCH NESTED LOOP JOIN` operation.

* Fixed an issue that the observer process unexpectedly exits because no deep copy that allocates the memory is performed when the PL engine executes dynamic SQL statements.

* Fixed an issue that the observer process unexpectedly exits because `like Number` is used as a filter condition.

* Fixed an issue that the observer process unexpectedly exits when the redo log module prints logs.

* Fixed an issue that an error is returned when the `SHOW PROCEDURE STATUS` statement is executed after the execution of the `DROP USER` statement.

* Fixed an issue that the `plan_type` field of the `sql_audit` parameter displays incorrect plan type.

### Upgrade and limitations

* The primary and standby clusters can be upgraded only in maximum performance mode. If a cluster is in maximum protection mode or maximum availability mode, you must switch the cluster to maximum performance mode before you can upgrade the cluster.

* PL debugging is supported only for x86 platforms. We recommend that you do not use this feature on an ARM platform.

## V2.2.77 BP4

### Version information

* Release date: July 13, 2021

* Version: V2.2.77 BP4
  
* RPM version: oceanbase-2.2.77-20210712224820

### Enhanced features

* The `MAKETIME()` function is supported in MySQL mode.

* The `UTC_DATE(), UTC_TIME(), and GET_FORMAT()` functions are supported in MySQL mode.

### Bug fixes

* Fixed an issue that `XA transactions` in the `Active` status cannot be rolled back.

* Fixed an issue that in Oracle mode, if the index column contains the `CHAR` data type and values that are less than or equal to 0, the index column cannot be queried.

* Fixed an issue that the execution of the `ANTI-, SEMI-, and OUTER-JOIN` statements with an `OR` join condition generates incorrect data.

* Fixed an issue that the observer process unexpectedly exits because of an `OSS SDK bug` during the physical backup to the Alibaba Cloud OSS bucket.

* Fixed an issue that the observer process unexpectedly exits sometimes because of queries on the `gv$sysstat` view.

### Upgrade and limitations

* The primary and standby clusters can be upgraded only in maximum performance mode. If a cluster is in maximum protection mode or maximum availability mode, you must switch the cluster to maximum performance mode before you can upgrade the cluster.

* PL debugging is supported only for x86 platforms. We recommend that you do not use this feature on an ARM platform.

## V2.2.77 BP3

### Version information

* Release date: June 18, 2021

* Version: V2.2.77 BP3

* RPM version: oceanbase-2.2.77-20210618130343

### Enhanced features

* The `LOG(), LN(), PI(), RADIANS(), ATAN(), ASIN(), ACOS(), and COT()` functions are supported in MySQL mode.

* The `MONTHNAME()` function is supported in MySQL mode.

* The `LAST_DAY()` function is supported in MySQL mode.

* The `QUARTER()` function is supported in MySQL mode.

* The `BIT_LENGTH()` function is supported in MySQL mode.

### Bug fixes

* Fixed an issue that the observer process unexpectedly exits during the packet return process of a query because of network exceptions.

* Fixed an issue that the parallel execution framework has memory leaks.

* Fixed an issue that the observer process unexpectedly exits during the process of obtaining the `partition location` because of concurrent memory requests.

* Fixed an issue that the observer process unexpectedly exits during the eviction of the plan cache because of the access to a null pointer.

* Fixed an issue that the observer process unexpectedly exits because of stack overflow, which is caused by a large number of static SQL statements in the anonymous block when `prepared statement` is disabled.

* Fixed an issue that the execution of the `SELF ANTI JOIN` statement results in an incorrect estimation of the number of rows because of SQL rewriting.

* Fixed an issue that the `OB_ARCHIVE_TEMP_MEMORY` module has memory leaks during log archiving.

* Fixed an issue that the PL statement cannot hit the `plan cache`.

* Fixed an issue that the OBServer node retains the session after the client is disconnected.

### Upgrade and limitations

* The primary and standby clusters can be upgraded only in maximum performance mode. If a cluster is in maximum protection mode or maximum availability mode, you must switch the cluster to maximum performance mode before you can upgrade the cluster.

* PL debugging is supported only for x86 platforms. We recommend that you do not use this feature on an ARM platform.

## V2.2.77 BP2
### Version information

* Release date: June 4, 2021

* Version: V2.2.77 BP2
  
* RPM version: oceanbase-2.2.77-20210604113922

### Enhanced features

* In MySQL mode, using escape characters such as single quotation marks (' ') in a `LIKE` statement is supported.

* You can explicitly disable the enforced routing of a transaction after it is complete by setting the tenant-level parameter `ob_proxy_readonly_transaction_routing_policy`. This way, all SQL statements in the transaction are forwarded to the same OBServer node.

* The memory size that can be utilized by `sql_audit` of an OceanBase tenant is increased.

* The timeout wait for asynchronous I/O is optimized.

### Bug fixes

* Fixed an issue that the `RootServer` node of the standby cluster occasionally exits unexpectedly.

* Fixed an issue that the parameter that specifies the maximum memory available for `sql_audit` does not take effect.

* Fixed an issue that when the `GBK` character set is used, two consecutive queries that use Chinese characters return incorrect `filed name` even if the data is correct.

### Upgrade and limitations

* The primary and standby clusters can be upgraded only in maximum performance mode. If a cluster is in maximum protection mode or maximum availability mode, you must switch the cluster to maximum performance mode before you can upgrade the cluster.

* PL debugging is supported only for x86 platforms. We recommend that you do not use this feature on an ARM platform.

## V2.2.77 BP1
### Version information

* Release date: May 27, 2021.

* Version: V2.2.77 BP1
  
* RPM version: oceanbase-2.2.77-20210526202046

### Enhanced features

You can specify the maximum memory usage of partitions in a transaction by setting the tenant-level parameter `_tenant_max_trx_size`.

### Bug fixes

* Fixed an issue that the observer process unexpectedly exits when the memory is insufficient and the memory request fails.

* Fixed an issue that the `plan cache` has memory leaks.

* Fixed an issue that the `Nested Loop Join` operator may cause the observer process to unexpectedly exit in the TABLE ACCESS BY INDEX PRIMARY KEY operation.

* Fixed an issue that when foreign keys exist, the `Semi-Join` rewrite generates incorrect results.

* Fixed an issue that the observer process unexpectedly exits when an intermediate result set is released.

* Fixed an issue that in Oracle mode, the `WIDTH_BUCKET()` function is incompatible with Oracle when `min_value` is less than `expression`.

* Fixed an issue that in Oracle mode, the `RPAD()` function is incompatible with Oracle.

### Upgrade and limitations

* The primary and standby clusters can be upgraded only in maximum performance mode. If a cluster is in maximum protection mode or maximum availability mode, you must switch the cluster to maximum performance mode before you can upgrade the cluster.

* PL debugging is supported only for x86 platforms. We recommend that you do not use this feature on an ARM platform.

## V2.2.77

### Version information

* Release date: May 8, 2021

* Version: V2.2.77

* RPM version: oceanbase-2.2.77-20210508211731

### Overview

OceanBase Database V2.2.X is a generally available series that provides products of higher availability, compatibility, and security for customers to batch launch multiple projects.

### Enhanced features

* Primary and standby clusters are enhanced.

* Physical backup and restore are supported.

* The encryption of an individual log-only replica at the zone level is supported.

* Template-based and non-template-based subpartitioned tables are supported.

* `Drop` and `Truncate` operations on partitioned tables are supported.

### Bug fixes

* Fixed an issue that an error is returned for the aligned read of the `4 KB` clog offset.

* Fixed an issue that an error is returned during the type derivation of an expression that contains `NULL`.