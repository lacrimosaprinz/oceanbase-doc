|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||

# 后台线程

下表列举出 OBServer 节点的一部分后台线程及其功能描述。大部分场景下用户无需关注其实现细节。

  <main id="notice" type='explain'>
    <h4>说明</h4>
    <p>在 OBServer 节点版本迭代中会对后台线程持续优化，因此有些后台线程会在版本升级的过程出现消失、合并等情况，也有可能会出现新的后台线程。</p>
  </main>

| 线程名 | 级别 | 归属模块 | 线程数量 | 功能描述 |
| --- | --- | --- | --- | --- |
|FrzInfoDet|租户|事务|2|周期性检查是否有新的 freeze_info |
| LockWaitMgr | 租户 | 事务 | 1 | 用于周期性检查超时时间，唤醒等锁的事务 |
| TenantWeakRe | 租户 | 事务 | 1 | 租户级别备机读时间戳生成线程 |
| TransService | 租户 | 事务 | 1 | 处理事务模块内部若干后台处理的异步任务，推 Ls 的 Checkpoint 等 |
| TransTimeWhe | 租户 | 事务 | max(cpu_num/24, 2) | 处理事务 2PC 流程的定时任务 |
| TsMgr | 进程 | 事务 | 1 | GTS 的后台任务处理线程：删除无用的租户，刷新各个租户的 GTS 等 |
| TSWorker | 进程 | 事务 | 1 | 处理远程 GTS 访问返回的结果，回调事务 |
| TxLoopWorker | 租户 | 事务 | 1 | 事务模块后台定时任务 |
| ArbSer | 进程 | 系统 | 1 | 仲裁 Server 定时从配置文件加载配置参数 |
| Blacklist | 进程 | 系统 | 2 | 负责探测与通信目的端 Server 之间的网络是否联通 |
| ConfigMgr | 进程 | 系统 | 1 | 用于配置项的刷新 |
| L0_G0 | 租户 | 系统 | 2+min_cpu * cpu_quota_concurrency | 处理大部分该租户请求 |
| L2_G0 | 租户 | 系统 | 1 | 专门处理嵌套层级为 2 的请求 |
| L3_G0 | 租户 | 系统 | 1 | 专门处理嵌套层级为 3 的请求 |
| L4_G0 | 租户 | 系统 | 1 | 专门处理嵌套层级为 4 的请求 |
| L5_G0 | 租户 | 系统 | 1 | 专门处理嵌套层级为 5 的请求 |
| L6_G0 | 租户 | 系统 | 1 | 专门处理嵌套层级为 6 的请求 |
| L7_G0 | 租户 | 系统 | 1 | 专门处理嵌套层级为 7 的请求 |
| L8_G0 | 租户 | 系统 | 1 | 专门处理嵌套层级为 8 的请求 |
| L9_G0 | 租户 | 系统 | 1 | 专门处理嵌套层级为 9 的请求 |
| LuaHandler | 进程 | 系统 | 1 | 处理应急场景的 Lua 请求以读取 observer 进程内部状态 |
| MemDumpTimer | 进程 | 系统 | 1 | 定时打印 MEMORY 日志 |
| MemoryDump | 进程 | 系统 | 1 | 定时统计内存信息 |
| MultiTenant | 进程 | 系统 | 1 | 负责刷多租户 CPU 配比，用于资源调度 |
| OB_PLOG | 进程 | 系统 | 1 | 异步打印 observer 进程诊断日志 |
| pnio | 进程 | 系统 | 由 net_thread_count 配置的参数决定 | 新网络框架 pkt-nio 的网络 IO 线程 |
| pnlisten | 进程 | 系统 | 1 | 监听 RPC 端口以及转发 RPC 连接到网络 IO 线程 |
| SignalHandle | 进程 | 系统 | 1 | 信号处理线程 |
| SignalWorker | 进程 | 系统 | 1 | 异步处理信号线程 |
| L0_G2 | 租户 | 选举 | min_cpu，最少 8 个 | 专门处理选举请求的线程 |
