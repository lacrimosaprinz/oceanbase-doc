|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||

# 磁盘 I/O 工具

## iostat

`iostat` 为用于查看磁盘输入输出的性能监控工具。

命令行形式：

```unknow
iostat [ options ] [ <interval> [ <count> ] ]
```

参数说明：

* options 取值如下：

  * -C：显示 CPU 使用情况。
  * -d：显示磁盘使用情况。
  * -k：以 KB 为单位显示。
  * -m：以 M 为单位显示。
  * -N：显示磁盘阵列(LVM) 信息。
  * -n：显示 NFS 使用情况。
  * -p[磁盘名称]：显示磁盘和分区的情况。
  * -t：显示终端和 CPU 的信息。
  * -x：显示详细信息。

* interval：输出刷新的间隔时间。

* count：输出的次数。

通过`iostat -x 1 3`命令查看磁盘输入输出的详细信息。示例如下：

```unknow
$iostat -x 1 3
avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           0.03    0.00    0.00    0.00    0.00   99.97

Device:         rrqm/s   wrqm/s     r/s     w/s   rsec/s   wsec/s avgrq-sz avgqu-sz   await  svctm  %util
sda               0.00     0.00    1.00    0.00    16.00     0.00    16.00     0.00    0.00   0.00   0.00
sdb               0.00     0.00    0.00    0.00     0.00     0.00     0.00     0.00    0.00   0.00   0.00
sdc               0.00     0.00    0.00    0.00     0.00     0.00     0.00     0.00    0.00   0.00   0.00
sdd               0.00     0.00    0.00    0.00     0.00     0.00     0.00     0.00    0.00   0.00   0.00
sde               0.00     0.00    0.00    0.00     0.00     0.00     0.00     0.00    0.00   0.00   0.00
sdf               0.00     0.00    0.00    0.00     0.00     0.00     0.00     0.00    0.00   0.00   0.00
sdg               0.00     0.00    0.00    0.00     0.00     0.00     0.00     0.00    0.00   0.00   0.00
sdh               0.00     0.00    0.00    0.00     0.00     0.00     0.00     0.00    0.00   0.00   0.00
sdi               0.00     0.00    0.00    0.00     0.00     0.00     0.00     0.00    0.00   0.00   0.00
sdj               0.00     0.00    0.00    0.00     0.00     0.00     0.00     0.00    0.00   0.00   0.00
sdk               0.00     0.00    0.00    0.00     0.00     0.00     0.00     0.00    0.00   0.00   0.00
sdl               0.00     0.00    0.00    0.00     0.00     0.00     0.00     0.00    0.00   0.00   0.00
md127             0.00     0.00    0.00    0.00     0.00     0.00     0.00     0.00    0.00   0.00   0.00
md126             0.00     0.00    0.00    0.00     0.00     0.00     0.00     0.00    0.00   0.00   0.00
```

字段说明：

* avg-cpu:

  * %user：CPU 在用户态下的时间百分比。
  * %nice：CPU 在带 Nice 值的用户态下的时间百分比。
  * %system：CPU 在内核态下的时间百分比。
  * %iowait：CPU 等待 I/O 时间的百分比。
  * %steal：管理程序维护另一个虚拟处理器时，虚拟 CPU 的无意识等待时间百分比。
  * %idle：CPU 空闲时间百分比。

* Device：磁盘名字。

* rrqm/s: 每秒合并的读操作数量。

* wrqm/s: 每秒合并的写操作数量。

* r/s: 每秒读 I/O 次数。

* w/s: 每秒写 I/O 次数。

* rsec/s: 每秒读扇区数。

* wsec/s: 每秒写扇区数。

* rkB/s: 每秒读 K 字节数。

* wkB/s: 每秒写 K 字节数。

* avgrq-sz: 平均每次 I/O 的数据大小。

* avgqu-sz: 平均 I/O 队列长度。

* await: 平均 I/O 操作的等待时间 (毫秒)。

* svctm: 平均 I/O 操作的服务时间 (毫秒)。

* %util: I/O 占用的 CPU 利用率。

  <main id="notice" type='explain'>
    <h4>说明</h4>
    <p>%util 表示磁盘的 I/O 使用情况，如果很高，则通常表明 I/O 有可能成为瓶颈。另外，await = 平均 I/O 操作的服务时间 + I/O 等待时间，所以如果 await 远大于 svctm，则说明 I/O 等待时间较长，I/O 队列较大。</p>
  </main>
