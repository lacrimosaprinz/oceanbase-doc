|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||

# 分析 ASH 报告

生成 ASH 报告后, 查看其内容以确定瞬时性能问题的可能原因。

## ASH 报告内容

ASH 报告中通过 ASH Report 部分记录采样的起止时间、分析的起止时间、诊断的时间、样本的数量、事件的数量和平均活动会话数量这些信息，生成 Top User Events、Top Events P1/P2/P3 Value、Top Phase of Execution、Top SQL with Top Events、Top SQL with Top Blocking Events、Complete List of SQL Text、Top Sessions、Top Blocking Sessions、Top latches 等 11 个模块的信息，从多个维度或组合（例如时间、会话、模块、操作或 SQL 语句）进行范围或目标的性能分析。

完整的报告显示如下：

```shell
# ASH Report

----

           Sample Begin: 2024-02-22 19:26:47

             Sample End: 2024-05-22 19:27:07

             ----------

    Analysis Begin Time: 2024-04-09 18:11:18

      Analysis End Time: 2024-04-10 09:53:45

           Elapsed Time: 56547(secs)

          Num of Sample: 3374

          Num of Events: 3374

Average Active Sessions: 0.060

----



## Top User Events:

----------------------------------------------------------------+--------------------+---------+

                                                           Event|          WAIT_CLASS|  % Event|

----------------------------------------------------------------+--------------------+---------+

                                              CPU + Wait for CPU|               OTHER|   92.77%|

                                                      palf write|           SYSTEM_IO|    3.82%|

                                       slog flush condition wait|         CONCURRENCY|    1.07%|

                                           db file compact write|           SYSTEM_IO|    0.92%|

                                  async rpc proxy condition wait|             NETWORK|    0.33%|

                               wait for network request in queue|             NETWORK|    0.24%|

                                             exec inner sql wait|               OTHER|    0.24%|

                                                      sleep wait|                IDLE|    0.18%|

                                            db file compact read|           SYSTEM_IO|    0.12%|

                                                       palf read|           SYSTEM_IO|    0.09%|

                                                        sync rpc|             NETWORK|    0.09%|

                                          default condition wait|         CONCURRENCY|    0.09%|

                                        latch: ls meta lock wait|         CONCURRENCY|    0.06%|

----------------------------------------------------------------+--------------------+---------+



## Top Events P1/P2/P3 Value:

----------------------------------------------------------------+----------+------------+--------------------------------------------------+--------------------+--------------------+--------------------+

                                                           Event|   % Event|  % Activity|                                      Max P1/P2/P3|         Parameter 1|         Parameter 2|         Parameter 3|

----------------------------------------------------------------+----------+------------+--------------------------------------------------+--------------------+--------------------+--------------------+

                                              CPU + Wait for CPU|    92.77%|     92.768%|                                       "0","0","0"|                    |                    |                    |

                                                      palf write|     3.82%|      3.823%|                           "406","66957312","8192"|                  fd|              offset|                size|

                                       slog flush condition wait|     1.07%|      1.067%|                         "140458332257256","0","0"|             address|                    |                    |

                                           db file compact write|     0.92%|      0.919%|                                    "8192","0","0"|                  fd|              offset|                size|

                                  async rpc proxy condition wait|     0.33%|      0.326%|                         "140454242609688","0","0"|             address|                    |                    |

                               wait for network request in queue|     0.24%|      0.237%|                                    "5387","0","2"|               pcode|               level|            priority|

                                             exec inner sql wait|     0.24%|      0.237%|                          "50004","3221699650","0"|wait inner sql class|    inner session id|                    |

                                                      sleep wait|     0.18%|      0.178%|                                 "5000000","0","0"|      sleep_interval|                    |                    |

                                            db file compact read|     0.12%|      0.119%|                                     "387","0","0"|                  fd|              offset|                size|

----------------------------------------------------------------+----------+------------+--------------------------------------------------+--------------------+--------------------+--------------------+



## Top Phase of Execution:

----------------------------------------+------------+--------------+----------------------------------------+

                      Phase of Execution|  % Activity|  Sample Count|                     Avg Active Sessions|

----------------------------------------+------------+--------------+----------------------------------------+

                         IN_STORAGE_READ|      0.178%|             6|                                    0.00|

                           IN_COMMITTING|      0.148%|             5|                                    0.00|

                         IN_SQL_OPTIMIZE|      0.030%|             1|                                    0.00|

                        IN_SQL_EXECUTION|      0.030%|             1|                                    0.00|

                        IN_STORAGE_WRITE|      0.030%|             1|                                    0.00|

                                IN_PARSE|      0.000%|             0|                                    0.00|

                             IN_PL_PARSE|      0.000%|             0|                                    0.00|

                           IN_PLAN_CACHE|      0.000%|             0|                                    0.00|

                         IN_PX_EXECUTION|      0.000%|             0|                                    0.00|

                        IN_SEQUENCE_LOAD|      0.000%|             0|                                    0.00|

                 IN_REMOTE_DAS_EXECUTION|      0.000%|             0|                                    0.00|

----------------------------------------+------------+--------------+----------------------------------------+



## Top SQL with Top Events

 - All events included.

 - Empty 'SQL Text' if it is PL/SQL query

----------------------------------------+------------+-------------------------+----------------------------------------------------------------+------------+------------------------------------------------------------+

                                  SQL ID|     PLAN ID|  Sampled # of Executions|                                                           Event|     % Event|                                                    SQL Text|

----------------------------------------+------------+-------------------------+----------------------------------------------------------------+------------+------------------------------------------------------------+

                                        |           0|                     3124|                                              CPU + Wait for CPU|      92.59%|                                                            |

                                        |           0|                      129|                                                      palf write|       3.82%|                                                            |

                                        |           0|                       36|                                       slog flush condition wait|       1.07%|                                                            |

                                        |           0|                       31|                                           db file compact write|       0.92%|                                                            |

                                        |           0|                       11|                                  async rpc proxy condition wait|       0.33%|                                                            |

                                        |           0|                        8|                                             exec inner sql wait|       0.24%|                                                            |

                                        |           0|                        8|                               wait for network request in queue|       0.24%|                                                            |

                                        |           0|                        6|                                                      sleep wait|       0.18%|                                                            |

        945096BAD4B3B7C7DA87D4F93AC22C4D|         394|                        5|                                              CPU + Wait for CPU|       0.15%|                                                            |

                                        |           0|                        4|                                            db file compact read|       0.12%|                                                            |

                                        |           0|                        3|                                                        sync rpc|       0.09%|                                                            |

                                        |           0|                        3|                                                       palf read|       0.09%|                                                            |

                                        |           0|                        3|                                          default condition wait|       0.09%|                                                            |

                                        |           0|                        2|                                        latch: ls meta lock wait|       0.06%|                                                            |

        8482C8137DA40CE77C9387299138C1E7|        1565|                        1|                                              CPU + Wait for CPU|       0.03%|     select "ANONYMOUS_VIEW2"."EXECUTION_PHASE" AS "EXECUTIO|

----------------------------------------+------------+-------------------------+----------------------------------------------------------------+------------+------------------------------------------------------------+



## Top SQL with Top Blocking Events

 - Empty result if no event other than On CPU sampled

 - Empty 'SQL Text' if it is PL/SQL query

----------------------------------------+------------+-------------------------+----------------------------------------------------------------+------------+------------------------------------------------------------+

                                  SQL ID|     PLAN ID|  Sampled # of Executions|                                                           Event|     % Event|                                                    SQL Text|

----------------------------------------+------------+-------------------------+----------------------------------------------------------------+------------+------------------------------------------------------------+

                                    NULL|           0|                      129|                                                      palf write|       3.82%|                                                            |

                                    NULL|           0|                       36|                                       slog flush condition wait|       1.07%|                                                            |

                                    NULL|           0|                       31|                                           db file compact write|       0.92%|                                                            |

                                    NULL|           0|                       11|                                  async rpc proxy condition wait|       0.33%|                                                            |

                                    NULL|           0|                        8|                               wait for network request in queue|       0.24%|                                                            |

                                    NULL|           0|                        6|                                                      sleep wait|       0.18%|                                                            |

                                    NULL|           0|                        4|                                            db file compact read|       0.12%|                                                            |

                                    NULL|           0|                        3|                                                       palf read|       0.09%|                                                            |

                                    NULL|           0|                        3|                                          default condition wait|       0.09%|                                                            |

                                    NULL|           0|                        3|                                                        sync rpc|       0.09%|                                                            |

                                    NULL|           0|                        2|                                        latch: ls meta lock wait|       0.06%|                                                            |

----------------------------------------+------------+-------------------------+----------------------------------------------------------------+------------+------------------------------------------------------------+



## Complete List of SQL Text

  SQL ID: 8482C8137DA40CE77C9387299138C1E7

 PLAN ID: 1565

SQL Text: select "ANONYMOUS_VIEW2"."EXECUTION_PHASE" AS "EXECUTION_PHASE","ANONYMOUS_VIEW2"."SAMPLES_CNT" AS "SAMPLES_CNT" from (select /*+ NO_REWRITE */ *  FROM (select sum((case "TOP_EVENT"."IN_PARSE" when 'N' then 0 else 1 end)) AS "IN_PARSE",sum((case "TOP_EVENT"."IN_PL_PARSE" when 'N' then 0 else 1 end)) AS "IN_PL_PARSE",sum((case "TOP_EVENT"."IN_PLAN_CACHE" when 'N' then 0 else 1 end)) AS "IN_PLAN_CACHE",sum((case "TOP_EVENT"."IN_SQL_OPTIMIZE" when 'N' then 0 else 1 end)) AS "IN_SQL_OPTIMIZE",sum((case "TOP_EVENT"."IN_SQL_EXECUTION" when 'N' then 0 else 1 end)) AS "IN_SQL_EXECUTION",sum((case "TOP_EVENT"."IN_PX_EXECUTION" when 'N' then 0 else 1 end)) AS "IN_PX_EXECUTION",sum((case "TOP_EVENT"."IN_SEQUENCE_LOAD" when 'N' then 0 else 1 end)) AS "IN_SEQUENCE_LOAD",sum((case "TOP_EVENT"."IN_COMMITTING" when 'N' then 0 else 1 end)) AS "IN_COMMITTING",sum((case "TOP_EVENT"."IN_STORAGE_READ" when 'N' then 0 else 1 end)) AS "IN_STORAGE_READ",sum((case "TOP_EVENT"."IN_STORAGE_WRITE" when 'N' then 0 else 1 end)) AS "IN_STORAGE_WRITE",sum((case "TOP_EVENT"."IN_REMOTE_DAS_EXECUTION" when 'N' then 0 else 1 end)) AS "IN_REMOTE_DAS_EXECUTION" from (select "UNIFIED_ASH"."SAMPLE_ID" AS "SAMPLE_ID","UNIFIED_ASH"."SAMPLE_TIME" AS "SAMPLE_TIME","UNIFIED_ASH"."SVR_IP" AS "SVR_IP","UNIFIED_ASH"."SVR_PORT" AS "SVR_PORT","UNIFIED_ASH"."CON_ID" AS "CON_ID","UNIFIED_ASH"."USER_ID" AS "USER_ID","UNIFIED_ASH"."SESSION_ID" AS "SESSION_ID","UNIFIED_ASH"."SESSION_TYPE" AS "SESSION_TYPE","UNIFIED_ASH"."SESSION_STATE" AS "SESSION_STATE","UNIFIED_ASH"."TOP_LEVEL_SQL_ID" AS "TOP_LEVEL_SQL_ID","UNIFIED_ASH"."SQL_ID" AS "SQL_ID","UNIFIED_ASH"."PLAN_ID" AS "PLAN_ID","UNIFIED_ASH"."TRACE_ID" AS "TRACE_ID","UNIFIED_ASH"."EVENT" AS "EVENT","UNIFIED_ASH"."EVENT_NO" AS "EVENT_NO","UNIFIED_ASH"."P1" AS "P1","UNIFIED_ASH"."P1TEXT" AS "P1TEXT","UNIFIED_ASH"."P2" AS "P2","UNIFIED_ASH"."P2TEXT" AS "P2TEXT","UNIFIED_ASH"."P3" AS "P3","UNIFIED_ASH"."P3TEXT" AS "P3TEXT","UNIFIED_ASH"."WAIT_CLASS" AS "WAIT_CLASS","UNIFIED_ASH"."WAIT_CLASS_ID" AS "WAIT_CLASS_ID","UNIFIED_ASH"."TIME_WAITED" AS "TIME_WAITED","UNIFIED_ASH"."SQL_PLAN_LINE_ID" AS "SQL_PLAN_LINE_ID","UNIFIED_ASH"."IN_PARSE" AS "IN_PARSE","UNIFIED_ASH"."IN_PL_PARSE" AS "IN_PL_PARSE","UNIFIED_ASH"."IN_PLAN_CACHE" AS "IN_PLAN_CACHE","UNIFIED_ASH"."IN_SQL_OPTIMIZE" AS "IN_SQL_OPTIMIZE","UNIFIED_ASH"."IN_SQL_EXECUTION" AS "IN_SQL_EXECUTION","UNIFIED_ASH"."IN_PX_EXECUTION" AS "IN_PX_EXECUTION","UNIFIED_ASH"."IN_SEQUENCE_LOAD" AS "IN_SEQUENCE_LOAD","UNIFIED_ASH"."IN_COMMITTING" AS "IN_COMMITTING","UNIFIED_ASH"."IN_STORAGE_READ" AS "IN_STORAGE_READ","UNIFIED_ASH"."IN_STORAGE_WRITE" AS "IN_STORAGE_WRITE","UNIFIED_ASH"."IN_REMOTE_DAS_EXECUTION" AS "IN_REMOTE_DAS_EXECUTION","UNIFIED_ASH"."IN_PLSQL_EXECUTION" AS "IN_PLSQL_EXECUTION","UNIFIED_ASH"."IN_PLSQL_COMPILATION" AS "IN_PLSQL_COMPILATION","UNIFIED_ASH"."PLSQL_ENTRY_OBJECT_ID" AS "PLSQL_ENTRY_OBJECT_ID","UNIFIED_ASH"."PLSQL_ENTRY_SUBPROGRAM_ID" AS "PLSQL_ENTRY_SUBPROGRAM_ID","UNIFIED_ASH"."PLSQL_ENTRY_SUBPROGRAM_NAME" AS "PLSQL_ENTRY_SUBPROGRAM_NAME","UNIFIED_ASH"."PLSQL_OBJECT_ID" AS "PLSQL_OBJECT_ID","UNIFIED_ASH"."PLSQL_SUBPROGRAM_ID" AS "PLSQL_SUBPROGRAM_ID","UNIFIED_ASH"."PLSQL_SUBPROGRAM_NAME" AS "PLSQL_SUBPROGRAM_NAME","UNIFIED_ASH"."MODULE" AS "MODULE","UNIFIED_ASH"."ACTION" AS "ACTION","UNIFIED_ASH"."CLIENT_ID" AS "CLIENT_ID" from (select "SYS"."A"."SAMPLE_ID" AS "SAMPLE_ID","SYS"."A"."SAMPLE_TIME" AS "SAMPLE_TIME","SYS"."A"."SVR_IP" AS "SVR_IP","SYS"."A"."SVR_PORT" AS "SVR_PORT","SYS"."A"."CON_ID" AS "CON_ID","SYS"."A"."USER_ID" AS "USER_ID","SYS"."A"."SESSION_ID" AS "SESSION_ID","SYS"."A"."SESSION_TYPE" AS "SESSION_TYPE","SYS"."A"."SESSION_STATE" AS "SESSION_STATE","SYS"."A"."TOP_LEVEL_SQL_ID" AS "TOP_LEVEL_SQL_ID","SYS"."A"."SQL_ID" AS "SQL_ID","SYS"."A"."PLAN_ID" AS "PLAN_ID","SYS"."A"."TRACE_ID" AS "TRACE_ID",NVL("SYS"."A"."EVENT",'CPU + Wait for CPU') AS "EVENT",NVL("SYS"."A"."EVENT_NO",1) AS "EVENT_NO","SYS"."A"."P1" AS "P1","SYS"."A"."P1TEXT" AS "P1TEXT","SYS"."



## Top PL/SQL Procedures

-> 'PL/SQL entry subprogram' represents the application's top-level

      entry-point(procedure, function, trigger, package initialization) into PL/SQL.

-> 'PL/SQL current subprogram' is the pl/sql subprogram being executed

      at the point of sampling . If the value is 'SQL', it represents

           the percentage of time spent executing SQL for the particular

      plsql entry subprogram

-> 'PL/SQL entry subprogram' represents the application's top-level

------------------------------------------------------------+------------------------------------------------------------+--------------------+

                                      PLSQL Entry Subprogram|                                    PLSQL Current Subprogram|          % Activity|

------------------------------------------------------------+------------------------------------------------------------+--------------------+

                                  oceanbase.__all_core_table|                                                          --|               0.27%|

------------------------------------------------------------+------------------------------------------------------------+--------------------+



## Top Sessions:

 - '# Samples Active' shows the number of ASH samples in which the session was found waiting for that particular event. The percentage shown in this column is calculated with respect to wall time.

--------------------+----------------------+----------------------------------------------------------------+------------+------------+--------------------+--------------------+

                 Sid|            % Activity|                                                           Event| Event Count|     % Event|                User|    # Samples Active|

--------------------+----------------------+----------------------------------------------------------------+------------+------------+--------------------+--------------------+

       5334349381632|                33.02%|                                              CPU + Wait for CPU|        1114|      33.02%|                    |   1114/56547[1.97%]|

       5226975199232|                 8.95%|                                              CPU + Wait for CPU|         302|       8.95%|                    |    302/56547[0.53%]|

       5295694675968|                 7.23%|                                              CPU + Wait for CPU|         244|       7.23%|                    |    244/56547[0.43%]|

       4793183502336|                 4.65%|                                              CPU + Wait for CPU|         157|       4.65%|                    |    157/56547[0.28%]|

       6279242186752|                 3.44%|                                              CPU + Wait for CPU|         116|       3.44%|                    |    116/56547[0.21%]|

       6283537154048|                 3.26%|                                              CPU + Wait for CPU|         110|       3.26%|                    |    110/56547[0.19%]|

       5368709120000|                 2.19%|                                              CPU + Wait for CPU|          74|       2.19%|                    |     74/56547[0.13%]|

       4720169058304|                 2.16%|                                                      palf write|          73|       2.16%|                    |     73/56547[0.13%]|

       5214090297344|                 2.10%|                                              CPU + Wait for CPU|          71|       2.10%|                    |     71/56547[0.13%]|

       4784593567744|                 2.10%|                                              CPU + Wait for CPU|          71|       2.10%|                    |     71/56547[0.13%]|

       4724464025600|                 1.66%|                                                      palf write|          56|       1.66%|                    |     56/56547[0.10%]|

       5085241278464|                 1.45%|                                              CPU + Wait for CPU|          49|       1.45%|                    |     49/56547[0.09%]|

       4840428142592|                 1.42%|                                              CPU + Wait for CPU|          48|       1.42%|                    |     48/56547[0.08%]|

       4797478469632|                 1.22%|                                              CPU + Wait for CPU|          41|       1.22%|                    |     41/56547[0.07%]|

       4690104287232|                 1.16%|                                              CPU + Wait for CPU|          39|       1.16%|                    |     39/56547[0.07%]|

       5115306049536|                 1.16%|                                              CPU + Wait for CPU|          39|       1.16%|                    |     39/56547[0.07%]|

       5244155068416|                 1.13%|                                              CPU + Wait for CPU|          38|       1.13%|                    |     38/56547[0.07%]|

       4771708665856|                 1.10%|                                              CPU + Wait for CPU|          37|       1.10%|                    |     37/56547[0.07%]|

       4715874091008|                 1.10%|                                              CPU + Wait for CPU|          37|       1.10%|                    |     37/56547[0.07%]|

--------------------+----------------------+----------------------------------------------------------------+------------+------------+--------------------+--------------------+



## Top Blocking Sessions:

 - Blocking session activity percentages are calculated with respect to waits on latches and locks only.

 - '# Samples Active' shows the number of ASH samples in which the blocking session was found active.

--------------------+----------------------+----------------------------------------+------------+------------+--------------------+--------------------+

        Blocking Sid|            % Activity|                            Event Caused| Event Count|     % Event|                User|    # Samples Active|

--------------------+----------------------+----------------------------------------+------------+------------+--------------------+--------------------+

       4720169058304|                 2.16%|                              palf write|          73|       2.16%|                    |     73/56547[0.13%]|

       4724464025600|                 1.66%|                              palf write|          56|       1.66%|                    |     56/56547[0.10%]|

       5158255722496|                 0.92%|                   db file compact write|          31|       0.92%|                    |     31/56547[0.05%]|

       4784593567744|                 0.83%|               slog flush condition wait|          28|       0.83%|                    |     28/56547[0.05%]|

       4771708665856|                 0.33%|          async rpc proxy condition wait|          11|       0.33%|                    |     11/56547[0.02%]|

                   0|                 0.24%|       wait for network request in queue|           8|       0.24%|                    |      8/56547[0.01%]|

       5299989643264|                 0.21%|               slog flush condition wait|           7|       0.21%|                    |      7/56547[0.01%]|

       5312874545152|                 0.15%|                              sleep wait|           5|       0.15%|                    |      5/56547[0.01%]|

       5471788335104|                 0.09%|                                sync rpc|           3|       0.09%|                    |      3/56547[0.01%]|

       5299989643264|                 0.09%|                               palf read|           3|       0.09%|                    |      3/56547[0.01%]|

       5106716114944|                 0.06%|                  default condition wait|           2|       0.06%|                    |      2/56547[0.00%]|

       5308579577856|                 0.06%|                latch: ls meta lock wait|           2|       0.06%|                    |      2/56547[0.00%]|

       5351529250816|                 0.06%|                    db file compact read|           2|       0.06%|                    |      2/56547[0.00%]|

       4986457030656|                 0.03%|                    db file compact read|           1|       0.03%|                    |      1/56547[0.00%]|

        176093659136|                 0.03%|                  default condition wait|           1|       0.03%|                    |      1/56547[0.00%]|

       4969277161472|                 0.03%|               slog flush condition wait|           1|       0.03%|                    |      1/56547[0.00%]|

       5381594021888|                 0.03%|                              sleep wait|           1|       0.03%|                    |      1/56547[0.00%]|

       4930622455808|                 0.03%|                    db file compact read|           1|       0.03%|                    |      1/56547[0.00%]|

--------------------+----------------------+----------------------------------------+------------+------------+--------------------+--------------------+



## Top latches:

----------------------------------------------------------------+--------------------+--------------------+

                                                           Latch|       Sampled Count|          % Activity|

----------------------------------------------------------------+--------------------+--------------------+

                                        latch: ls meta lock wait|                   2|               0.06%|

----------------------------------------------------------------+--------------------+--------------------+



## Node Load:

----------------------------------------+--------------------+--------------------+--------------------+------------------------------+

                                  SVR IP|            SVR PORT|       Sampled Count|     Idle Wait Count|                          Load|

----------------------------------------+--------------------+--------------------+--------------------+------------------------------+

                             xx.xx.xx.xx|                2882|                3374|                   6|                          0.06|

----------------------------------------+--------------------+--------------------+--------------------+------------------------------+
```

根据完整的 ASH 报告分析报告中每个节点的内容。

### ASH Report

这部分显示 ASH（Active Session History）报告中一些关于采样时间、分析时间和一般统计数据的信息。

* Sample Begin: 采样开始的时间，表示开始记录会话活动的时间点。
* Sample End: 采样结束的时间，表示停止记录会话活动的时间点。
* Analysis Begin Time: 分析开始的时间，表示对采样数据进行分析的起始时间点。
* Analysis End Time: 分析结束的时间，表示对采样数据进行分析的结束时间点。
* Elapsed Time: 所有采样时间的总秒数。
* Num of Sample: 采样的数量，表示记录到的会话活动次数。
* Num of Events: 事件的数量，表示记录到的事件次数。
* Average Active Sessions: 平均活跃会话数，表示在采样期间的平均活跃会话数量。

这些信息提供了关于 ASH 报告的统计数据，包括采样时间段、分析时间段、采样数量、事件数量和平均活跃会话数。通过这些数据可以了解采样期间的活动情况、会话和事件的数量，以及系统的活跃程度。

```shell
# ASH Report
----
           Sample Begin: 2024-02-22 19:26:47
             Sample End: 2024-05-22 19:27:07
             ----------
    Analysis Begin Time: 2024-04-09 18:11:18
      Analysis End Time: 2024-04-10 09:53:45
           Elapsed Time: 56547(secs)
          Num of Sample: 3374
          Num of Events: 3374
Average Active Sessions: 0.060
----
```

### Top User Events

这部分内容通过事件、事件类型、采样事件个数和等待事件占总时间的百分比等多个维度，罗列出了占采样会话活动百分比最高的用户进程中排名靠前的等待事件。

* Event: 显示用户事件的名称。包括了一些事件的名称，如 `CPU + Wait for CPU`、`palf write`、`slog flush condition wait` 等。

* WAIT_CLASS: 显示等待事件所属类型名称，用于将特定的用户事件分类。包括 OTHER、SYSTEM_IO、CONCURRENCY、NETWORK 等事件类型。

* % Event: 显示用户事件所占的百分比，表示特定用户事件在总等待时间中所占的比例。

这些信息提供了有关顶级用户事件的等待情况，包括事件名称、等待类别和所占百分比。

```shell
## Top User Events:

----------------------------------------------------------------+--------------------+---------+

                                                           Event|          WAIT_CLASS|  % Event|

----------------------------------------------------------------+--------------------+---------+

                                              CPU + Wait for CPU|               OTHER|   92.77%|

                                                      palf write|           SYSTEM_IO|    3.82%|

                                       slog flush condition wait|         CONCURRENCY|    1.07%|

                                           db file compact write|           SYSTEM_IO|    0.92%|

                                  async rpc proxy condition wait|             NETWORK|    0.33%|

                               wait for network request in queue|             NETWORK|    0.24%|

                                             exec inner sql wait|               OTHER|    0.24%|

                                                      sleep wait|                IDLE|    0.18%|

                                            db file compact read|           SYSTEM_IO|    0.12%|

                                                       palf read|           SYSTEM_IO|    0.09%|

                                                        sync rpc|             NETWORK|    0.09%|

                                          default condition wait|         CONCURRENCY|    0.09%|

                                        latch: ls meta lock wait|         CONCURRENCY|    0.06%|

----------------------------------------------------------------+--------------------+---------+
```

### Top Events P1/P2/P3 Value

这部分显示了顶级事件（Top Events）的详细信息，包括事件名称、事件百分比、活动百分比以及相关的参数（P1/P2/P3 值）。

* Event: 显示事件的名称。
* % Event: 显示该事件的百分比，表示该事件在总等待时间中所占的比例。
* % Activity: 显示该事件的活动百分比，表示该事件在总活动时间中所占的比例。
* Max P1/P2/P3: 显示与该事件相关的最大 P1/P2/P3 值。
* Parameter 1/2/3: 显示 P1/P2/P3 值的具体含义。

这些信息提供了关于顶级事件及其相关参数的详细信息。P1/P2/P3 值通常是用于提供更多关于事件的上下文和细节信息，如文件描述符（fd）、偏移量（offset）、大小（size）、地址（address）、代码（pcode）、级别（level）、优先级（priority）等。

```shell
## Top Events P1/P2/P3 Value:

----------------------------------------------------------------+----------+------------+--------------------------------------------------+--------------------+--------------------+--------------------+

                                                           Event|   % Event|  % Activity|                                      Max P1/P2/P3|         Parameter 1|         Parameter 2|         Parameter 3|

----------------------------------------------------------------+----------+------------+--------------------------------------------------+--------------------+--------------------+--------------------+

                                              CPU + Wait for CPU|    92.77%|     92.768%|                                       "0","0","0"|                    |                    |                    |

                                                      palf write|     3.82%|      3.823%|                           "406","66957312","8192"|                  fd|              offset|                size|

                                       slog flush condition wait|     1.07%|      1.067%|                         "140458332257256","0","0"|             address|                    |                    |

                                           db file compact write|     0.92%|      0.919%|                                    "8192","0","0"|                  fd|              offset|                size|

                                  async rpc proxy condition wait|     0.33%|      0.326%|                         "140454242609688","0","0"|             address|                    |                    |

                               wait for network request in queue|     0.24%|      0.237%|                                    "5387","0","2"|               pcode|               level|            priority|

                                             exec inner sql wait|     0.24%|      0.237%|                          "50004","3221699650","0"|wait inner sql class|    inner session id|                    |

                                                      sleep wait|     0.18%|      0.178%|                                 "5000000","0","0"|      sleep_interval|                    |                    |

                                            db file compact read|     0.12%|      0.119%|                                     "387","0","0"|                  fd|              offset|                size|

----------------------------------------------------------------+----------+------------+--------------------------------------------------+--------------------+--------------------+--------------------+
```

### Top Phase of Execution

这部分显示了执行阶段（Phase of Execution）的信息。

* Phase of Execution: 显示执行阶段的名称。
* % Activity: 显示该阶段所占的活动百分比，表示该阶段在总活动时间中所占的比例。
* Sample Count: 显示采样计数，表示采样期间记录到的属于该阶段的会话数量。
* Avg Active Sessions: 显示平均活跃会话数，表示在采样期间该阶段的平均活跃会话数量。

这些信息提供了关于执行阶段及其在总活动时间中的百分比、采样计数和平均活跃会话数的统计数据。执行阶段可以反映系统中各个阶段的活动情况，如读取（IN_STORAGE_READ）、提交（IN_COMMITTING）、SQL 优化（IN_SQL_OPTIMIZE）等等。

```shell
## Top Phase of Execution:

----------------------------------------+------------+--------------+----------------------------------------+

                      Phase of Execution|  % Activity|  Sample Count|                     Avg Active Sessions|

----------------------------------------+------------+--------------+----------------------------------------+

                         IN_STORAGE_READ|      0.178%|             6|                                    0.00|

                           IN_COMMITTING|      0.148%|             5|                                    0.00|

                         IN_SQL_OPTIMIZE|      0.030%|             1|                                    0.00|

                        IN_SQL_EXECUTION|      0.030%|             1|                                    0.00|

                        IN_STORAGE_WRITE|      0.030%|             1|                                    0.00|

                                IN_PARSE|      0.000%|             0|                                    0.00|

                             IN_PL_PARSE|      0.000%|             0|                                    0.00|

                           IN_PLAN_CACHE|      0.000%|             0|                                    0.00|

                         IN_PX_EXECUTION|      0.000%|             0|                                    0.00|

                        IN_SEQUENCE_LOAD|      0.000%|             0|                                    0.00|

                 IN_REMOTE_DAS_EXECUTION|      0.000%|             0|                                    0.00|

----------------------------------------+------------+--------------+----------------------------------------+

```

### Top SQL with Top Events

这部分显示了具有顶级事件（Top Events）的顶级 SQL 查询的信息。

* SQL ID: 显示 SQL 查询的 ID。
* PLAN ID: 显示查询计划的 ID。
* Sampled # of Executions: 显示采样期间该 SQL 查询的执行次数。
* Event: 显示与该 SQL 查询相关的事件名称。
* % Event: 显示该事件在该 SQL 查询的总等待时间中所占的百分比。
* SQL Text: 显示 SQL 查询的文本。如果是 PL/SQL 查询，则可能为空。

这些信息提供了关于具有顶级事件的顶级SQL查询的统计数据。可以根据 SQL ID 和 PLAN ID 来识别具体的 SQL 查询和查询计划。同时，还显示了每个 SQL 查询的事件和事件百分比，以及查询的执行次数。

```shell
## Top SQL with Top Events

 - All events included.

 - Empty 'SQL Text' if it is PL/SQL query

----------------------------------------+------------+-------------------------+----------------------------------------------------------------+------------+------------------------------------------------------------+

                                  SQL ID|     PLAN ID|  Sampled # of Executions|                                                           Event|     % Event|                                                    SQL Text|

----------------------------------------+------------+-------------------------+----------------------------------------------------------------+------------+------------------------------------------------------------+

                                        |           0|                     3124|                                              CPU + Wait for CPU|      92.59%|                                                            |

                                        |           0|                      129|                                                      palf write|       3.82%|                                                            |

                                        |           0|                       36|                                       slog flush condition wait|       1.07%|                                                            |

                                        |           0|                       31|                                           db file compact write|       0.92%|                                                            |

                                        |           0|                       11|                                  async rpc proxy condition wait|       0.33%|                                                            |

                                        |           0|                        8|                                             exec inner sql wait|       0.24%|                                                            |

                                        |           0|                        8|                               wait for network request in queue|       0.24%|                                                            |

                                        |           0|                        6|                                                      sleep wait|       0.18%|                                                            |

        945096BAD4B3B7C7DA87D4F93AC22C4D|         394|                        5|                                              CPU + Wait for CPU|       0.15%|                                                            |

                                        |           0|                        4|                                            db file compact read|       0.12%|                                                            |

                                        |           0|                        3|                                                        sync rpc|       0.09%|                                                            |

                                        |           0|                        3|                                                       palf read|       0.09%|                                                            |

                                        |           0|                        3|                                          default condition wait|       0.09%|                                                            |

                                        |           0|                        2|                                        latch: ls meta lock wait|       0.06%|                                                            |

        8482C8137DA40CE77C9387299138C1E7|        1565|                        1|                                              CPU + Wait for CPU|       0.03%|     select "ANONYMOUS_VIEW2"."EXECUTION_PHASE" AS "EXECUTIO|

----------------------------------------+------------+-------------------------+----------------------------------------------------------------+------------+------------------------------------------------------------+
```

### Top SQL with Top Blocking Events

这部分显示具有顶级阻塞事件（Top Blocking Events）的顶级 SQL 查询的信息。

<main id="notice" type='explain'>
  <h4>说明</h4>
  <p>如果没有除了 <code>On CPU sampled</code> 之外的事件存在，结果可能为空。在这种情况下，没有显示与 SQL 查询相关的阻塞事件。</p>
</main>

* SQL ID: 显示 SQL 查询的 ID。
* PLAN ID: 显示查询计划的 ID。
* Sampled # of Executions: 显示采样期间该 SQL 查询的执行次数。
* Event: 显示与该 SQL 查询相关的阻塞事件名称。
* % Event: 显示该阻塞事件在该 SQL 查询的总等待时间中所占的百分比。
* SQL Text: 显示 SQL 查询的文本。如果是 PL/SQL 查询，则可能为空。

这些信息提供了关于具有顶级阻塞事件的顶级 SQL 查询的统计数据。可以根据 SQL ID 和 PLAN ID 来识别具体的 SQL 查询和查询计划。同时，还显示了每个 SQL 查询的阻塞事件和事件百分比，以及查询的执行次数。

```shell
## Top SQL with Top Blocking Events

 - Empty result if no event other than On CPU sampled

 - Empty 'SQL Text' if it is PL/SQL query

----------------------------------------+------------+-------------------------+----------------------------------------------------------------+------------+------------------------------------------------------------+

                                  SQL ID|     PLAN ID|  Sampled # of Executions|                                                           Event|     % Event|                                                    SQL Text|

----------------------------------------+------------+-------------------------+----------------------------------------------------------------+------------+------------------------------------------------------------+

                                    NULL|           0|                      129|                                                      palf write|       3.82%|                                                            |

                                    NULL|           0|                       36|                                       slog flush condition wait|       1.07%|                                                            |

                                    NULL|           0|                       31|                                           db file compact write|       0.92%|                                                            |

                                    NULL|           0|                       11|                                  async rpc proxy condition wait|       0.33%|                                                            |

                                    NULL|           0|                        8|                               wait for network request in queue|       0.24%|                                                            |

                                    NULL|           0|                        6|                                                      sleep wait|       0.18%|                                                            |

                                    NULL|           0|                        4|                                            db file compact read|       0.12%|                                                            |

                                    NULL|           0|                        3|                                                       palf read|       0.09%|                                                            |

                                    NULL|           0|                        3|                                          default condition wait|       0.09%|                                                            |

                                    NULL|           0|                        3|                                                        sync rpc|       0.09%|                                                            |

                                    NULL|           0|                        2|                                        latch: ls meta lock wait|       0.06%|                                                            |

----------------------------------------+------------+-------------------------+----------------------------------------------------------------+------------+------------------------------------------------------------+
```

### Complete List of SQL Text

这部分显示完整的 SQL 文本（SQL Text）的列表。该列表包含了 SQL 查询的 SQL ID、计划 ID（PLAN ID）以及 SQL 查询的文本信息。

每个条目包含以下信息：

* SQL ID: SQL 查询的唯一标识符。
* PLAN ID: 查询计划的标识符。
* Sampled # of Executions: 查询执行的采样次数。
* Event: 与该 SQL 查询相关的事件名称。
* % Event: 该事件在总等待时间中所占的百分比。
* SQL Text: SQL 查询的文本。

这些信息提供了关于 SQL 查询的完整列表，可以用于识别、分析和优化查询性能。

```shell
## Complete List of SQL Text

  SQL ID: 8482C8137DA40CE77C9387299138C1E7

 PLAN ID: 1565

SQL Text: select "ANONYMOUS_VIEW2"."EXECUTION_PHASE" AS "EXECUTION_PHASE","ANONYMOUS_VIEW2"."SAMPLES_CNT" AS "SAMPLES_CNT" from (select /*+ NO_REWRITE */ *  FROM (select sum((case "TOP_EVENT"."IN_PARSE" when 'N' then 0 else 1 end)) AS "IN_PARSE",sum((case "TOP_EVENT"."IN_PL_PARSE" when 'N' then 0 else 1 end)) AS "IN_PL_PARSE",sum((case "TOP_EVENT"."IN_PLAN_CACHE" when 'N' then 0 else 1 end)) AS "IN_PLAN_CACHE",sum((case "TOP_EVENT"."IN_SQL_OPTIMIZE" when 'N' then 0 else 1 end)) AS "IN_SQL_OPTIMIZE",sum((case "TOP_EVENT"."IN_SQL_EXECUTION" when 'N' then 0 else 1 end)) AS "IN_SQL_EXECUTION",sum((case "TOP_EVENT"."IN_PX_EXECUTION" when 'N' then 0 else 1 end)) AS "IN_PX_EXECUTION",sum((case "TOP_EVENT"."IN_SEQUENCE_LOAD" when 'N' then 0 else 1 end)) AS "IN_SEQUENCE_LOAD",sum((case "TOP_EVENT"."IN_COMMITTING" when 'N' then 0 else 1 end)) AS "IN_COMMITTING",sum((case "TOP_EVENT"."IN_STORAGE_READ" when 'N' then 0 else 1 end)) AS "IN_STORAGE_READ",sum((case "TOP_EVENT"."IN_STORAGE_WRITE" when 'N' then 0 else 1 end)) AS "IN_STORAGE_WRITE",sum((case "TOP_EVENT"."IN_REMOTE_DAS_EXECUTION" when 'N' then 0 else 1 end)) AS "IN_REMOTE_DAS_EXECUTION" from (select "UNIFIED_ASH"."SAMPLE_ID" AS "SAMPLE_ID","UNIFIED_ASH"."SAMPLE_TIME" AS "SAMPLE_TIME","UNIFIED_ASH"."SVR_IP" AS "SVR_IP","UNIFIED_ASH"."SVR_PORT" AS "SVR_PORT","UNIFIED_ASH"."CON_ID" AS "CON_ID","UNIFIED_ASH"."USER_ID" AS "USER_ID","UNIFIED_ASH"."SESSION_ID" AS "SESSION_ID","UNIFIED_ASH"."SESSION_TYPE" AS "SESSION_TYPE","UNIFIED_ASH"."SESSION_STATE" AS "SESSION_STATE","UNIFIED_ASH"."TOP_LEVEL_SQL_ID" AS "TOP_LEVEL_SQL_ID","UNIFIED_ASH"."SQL_ID" AS "SQL_ID","UNIFIED_ASH"."PLAN_ID" AS "PLAN_ID","UNIFIED_ASH"."TRACE_ID" AS "TRACE_ID","UNIFIED_ASH"."EVENT" AS "EVENT","UNIFIED_ASH"."EVENT_NO" AS "EVENT_NO","UNIFIED_ASH"."P1" AS "P1","UNIFIED_ASH"."P1TEXT" AS "P1TEXT","UNIFIED_ASH"."P2" AS "P2","UNIFIED_ASH"."P2TEXT" AS "P2TEXT","UNIFIED_ASH"."P3" AS "P3","UNIFIED_ASH"."P3TEXT" AS "P3TEXT","UNIFIED_ASH"."WAIT_CLASS" AS "WAIT_CLASS","UNIFIED_ASH"."WAIT_CLASS_ID" AS "WAIT_CLASS_ID","UNIFIED_ASH"."TIME_WAITED" AS "TIME_WAITED","UNIFIED_ASH"."SQL_PLAN_LINE_ID" AS "SQL_PLAN_LINE_ID","UNIFIED_ASH"."IN_PARSE" AS "IN_PARSE","UNIFIED_ASH"."IN_PL_PARSE" AS "IN_PL_PARSE","UNIFIED_ASH"."IN_PLAN_CACHE" AS "IN_PLAN_CACHE","UNIFIED_ASH"."IN_SQL_OPTIMIZE" AS "IN_SQL_OPTIMIZE","UNIFIED_ASH"."IN_SQL_EXECUTION" AS "IN_SQL_EXECUTION","UNIFIED_ASH"."IN_PX_EXECUTION" AS "IN_PX_EXECUTION","UNIFIED_ASH"."IN_SEQUENCE_LOAD" AS "IN_SEQUENCE_LOAD","UNIFIED_ASH"."IN_COMMITTING" AS "IN_COMMITTING","UNIFIED_ASH"."IN_STORAGE_READ" AS "IN_STORAGE_READ","UNIFIED_ASH"."IN_STORAGE_WRITE" AS "IN_STORAGE_WRITE","UNIFIED_ASH"."IN_REMOTE_DAS_EXECUTION" AS "IN_REMOTE_DAS_EXECUTION","UNIFIED_ASH"."IN_PLSQL_EXECUTION" AS "IN_PLSQL_EXECUTION","UNIFIED_ASH"."IN_PLSQL_COMPILATION" AS "IN_PLSQL_COMPILATION","UNIFIED_ASH"."PLSQL_ENTRY_OBJECT_ID" AS "PLSQL_ENTRY_OBJECT_ID","UNIFIED_ASH"."PLSQL_ENTRY_SUBPROGRAM_ID" AS "PLSQL_ENTRY_SUBPROGRAM_ID","UNIFIED_ASH"."PLSQL_ENTRY_SUBPROGRAM_NAME" AS "PLSQL_ENTRY_SUBPROGRAM_NAME","UNIFIED_ASH"."PLSQL_OBJECT_ID" AS "PLSQL_OBJECT_ID","UNIFIED_ASH"."PLSQL_SUBPROGRAM_ID" AS "PLSQL_SUBPROGRAM_ID","UNIFIED_ASH"."PLSQL_SUBPROGRAM_NAME" AS "PLSQL_SUBPROGRAM_NAME","UNIFIED_ASH"."MODULE" AS "MODULE","UNIFIED_ASH"."ACTION" AS "ACTION","UNIFIED_ASH"."CLIENT_ID" AS "CLIENT_ID" from (select "SYS"."A"."SAMPLE_ID" AS "SAMPLE_ID","SYS"."A"."SAMPLE_TIME" AS "SAMPLE_TIME","SYS"."A"."SVR_IP" AS "SVR_IP","SYS"."A"."SVR_PORT" AS "SVR_PORT","SYS"."A"."CON_ID" AS "CON_ID","SYS"."A"."USER_ID" AS "USER_ID","SYS"."A"."SESSION_ID" AS "SESSION_ID","SYS"."A"."SESSION_TYPE" AS "SESSION_TYPE","SYS"."A"."SESSION_STATE" AS "SESSION_STATE","SYS"."A"."TOP_LEVEL_SQL_ID" AS "TOP_LEVEL_SQL_ID","SYS"."A"."SQL_ID" AS "SQL_ID","SYS"."A"."PLAN_ID" AS "PLAN_ID","SYS"."A"."TRACE_ID" AS "TRACE_ID",NVL("SYS"."A"."EVENT",'CPU + Wait for CPU') AS "EVENT",NVL("SYS"."A"."EVENT_NO",1) AS "EVENT_NO","SYS"."A"."P1" AS "P1","SYS"."A"."P1TEXT" AS "P1TEXT","SYS"."
```

### Top PL/SQL Procedures

这部分显示了 Top PL/SQL 存储过程的信息。

* PL/SQL Entry Subprogram: 显示应用程序的顶级 PL/SQL 入口子程序，它可以是过程（procedure）、函数（function）、触发器（trigger）或包的初始化（package initialization）。

* PL/SQL Current Subprogram: 显示当前正在执行的 PL/SQL 子程序，在采样点时正在执行的 PL/SQL 子程序。如果值为 `SQL`，则表示在特定 PL/SQL 入口子程序中执行 SQL 所占时间的百分比；如果值为 `--`，表示没有具体的子程序执行。

* % Activity: 显示活动百分比，表示特定 PL/SQL 入口子程序的活动百分比。

这些信息提供了有关 Top PL/SQL 存储过程的执行情况，包括顶级入口子程序和当前执行子程序的相关信息以及活动百分比。

```shell
## Top PL/SQL Procedures

-> 'PL/SQL entry subprogram' represents the application's top-level

      entry-point(procedure, function, trigger, package initialization) into PL/SQL.

-> 'PL/SQL current subprogram' is the pl/sql subprogram being executed

      at the point of sampling . If the value is 'SQL', it represents

           the percentage of time spent executing SQL for the particular

      plsql entry subprogram

-> 'PL/SQL entry subprogram' represents the application's top-level

------------------------------------------------------------+------------------------------------------------------------+--------------------+

                                      PLSQL Entry Subprogram|                                    PLSQL Current Subprogram|          % Activity|

------------------------------------------------------------+------------------------------------------------------------+--------------------+

                                  oceanbase.__all_core_table|                                                          --|               0.27%|

------------------------------------------------------------+------------------------------------------------------------+--------------------+

```

### Top Sessions

这部分以 Session 为维度进行排序统计活跃的 Session。通过采样的会话 ID、活动会话百分比、事件、事件个数、事件百分比，当前用户和采样的活动状态之间的比较，方便找到潜藏的问题 Session。
这部分显示顶级会话（Top Sessions）的信息。

* Sid: 显示会话的标识符。
* % Activity: 显示该会话的活动百分比，表示该会话在总活动时间中所占的比例。
* Event: 显示与该会话相关的事件名称。
* Event Count: 显示该会话遇到该事件的次数。
* % Event: 显示该事件在该会话的总事件次数中所占的百分比。
* User: 显示该会话所属的用户。
* Samples Active: 显示在ASH采样中该会话等待特定事件的次数，并在括号中显示相对于采样总次数的百分比。

这些信息提供了关于顶级会话的统计数据，包括会话标识符、活动百分比、相关事件、事件次数以及所属用户。

```shell
## Top Sessions:

 - '# Samples Active' shows the number of ASH samples in which the session was found waiting for that particular event. The percentage shown in this column is calculated with respect to wall time.

--------------------+----------------------+----------------------------------------------------------------+------------+------------+--------------------+--------------------+

                 Sid|            % Activity|                                                           Event| Event Count|     % Event|                User|    # Samples Active|

--------------------+----------------------+----------------------------------------------------------------+------------+------------+--------------------+--------------------+

       5334349381632|                33.02%|                                              CPU + Wait for CPU|        1114|      33.02%|                    |   1114/56547[1.97%]|

       5226975199232|                 8.95%|                                              CPU + Wait for CPU|         302|       8.95%|                    |    302/56547[0.53%]|

       5295694675968|                 7.23%|                                              CPU + Wait for CPU|         244|       7.23%|                    |    244/56547[0.43%]|

       4793183502336|                 4.65%|                                              CPU + Wait for CPU|         157|       4.65%|                    |    157/56547[0.28%]|

       6279242186752|                 3.44%|                                              CPU + Wait for CPU|         116|       3.44%|                    |    116/56547[0.21%]|

       6283537154048|                 3.26%|                                              CPU + Wait for CPU|         110|       3.26%|                    |    110/56547[0.19%]|

       5368709120000|                 2.19%|                                              CPU + Wait for CPU|          74|       2.19%|                    |     74/56547[0.13%]|

       4720169058304|                 2.16%|                                                      palf write|          73|       2.16%|                    |     73/56547[0.13%]|

       5214090297344|                 2.10%|                                              CPU + Wait for CPU|          71|       2.10%|                    |     71/56547[0.13%]|

       4784593567744|                 2.10%|                                              CPU + Wait for CPU|          71|       2.10%|                    |     71/56547[0.13%]|

       4724464025600|                 1.66%|                                                      palf write|          56|       1.66%|                    |     56/56547[0.10%]|

       5085241278464|                 1.45%|                                              CPU + Wait for CPU|          49|       1.45%|                    |     49/56547[0.09%]|

       4840428142592|                 1.42%|                                              CPU + Wait for CPU|          48|       1.42%|                    |     48/56547[0.08%]|

       4797478469632|                 1.22%|                                              CPU + Wait for CPU|          41|       1.22%|                    |     41/56547[0.07%]|

       4690104287232|                 1.16%|                                              CPU + Wait for CPU|          39|       1.16%|                    |     39/56547[0.07%]|

       5115306049536|                 1.16%|                                              CPU + Wait for CPU|          39|       1.16%|                    |     39/56547[0.07%]|

       5244155068416|                 1.13%|                                              CPU + Wait for CPU|          38|       1.13%|                    |     38/56547[0.07%]|

       4771708665856|                 1.10%|                                              CPU + Wait for CPU|          37|       1.10%|                    |     37/56547[0.07%]|

       4715874091008|                 1.10%|                                              CPU + Wait for CPU|          37|       1.10%|                    |     37/56547[0.07%]|

--------------------+----------------------+----------------------------------------------------------------+------------+------------+--------------------+--------------------+
```

### Top Blocking Sessions

这部分显示顶级阻塞会话（Top Blocking Sessions）的信息。

* Blocking Sid: 显示阻塞会话的标识符。
* % Activity: 显示该阻塞会话的活动百分比，表示该会话在等待闩锁（latches）和锁（locks）时所占的比例。
* Event Caused: 显示由该阻塞会话引起的事件名称。
* Event Count: 显示该阻塞会话引起的事件的次数。
* % Event: 显示该事件在阻塞会话引起的总事件次数中所占的百分比。
* User: 显示阻塞会话所属的用户。
* Samples Active: 显示在 ASH 采样中阻塞会话的活动次数，并在括号中显示相对于采样总次数的百分比。

这些信息提供了关于顶级阻塞会话的统计数据，包括会话标识符、活动百分比、引起的事件、事件次数以及所属用户。

```shell
## Top Blocking Sessions:

 - Blocking session activity percentages are calculated with respect to waits on latches and locks only.

 - '# Samples Active' shows the number of ASH samples in which the blocking session was found active.

--------------------+----------------------+----------------------------------------+------------+------------+--------------------+--------------------+

        Blocking Sid|            % Activity|                            Event Caused| Event Count|     % Event|                User|    # Samples Active|

--------------------+----------------------+----------------------------------------+------------+------------+--------------------+--------------------+

       4720169058304|                 2.16%|                              palf write|          73|       2.16%|                    |     73/56547[0.13%]|

       4724464025600|                 1.66%|                              palf write|          56|       1.66%|                    |     56/56547[0.10%]|

       5158255722496|                 0.92%|                   db file compact write|          31|       0.92%|                    |     31/56547[0.05%]|

       4784593567744|                 0.83%|               slog flush condition wait|          28|       0.83%|                    |     28/56547[0.05%]|

       4771708665856|                 0.33%|          async rpc proxy condition wait|          11|       0.33%|                    |     11/56547[0.02%]|

                   0|                 0.24%|       wait for network request in queue|           8|       0.24%|                    |      8/56547[0.01%]|

       5299989643264|                 0.21%|               slog flush condition wait|           7|       0.21%|                    |      7/56547[0.01%]|

       5312874545152|                 0.15%|                              sleep wait|           5|       0.15%|                    |      5/56547[0.01%]|

       5471788335104|                 0.09%|                                sync rpc|           3|       0.09%|                    |      3/56547[0.01%]|

       5299989643264|                 0.09%|                               palf read|           3|       0.09%|                    |      3/56547[0.01%]|

       5106716114944|                 0.06%|                  default condition wait|           2|       0.06%|                    |      2/56547[0.00%]|

       5308579577856|                 0.06%|                latch: ls meta lock wait|           2|       0.06%|                    |      2/56547[0.00%]|

       5351529250816|                 0.06%|                    db file compact read|           2|       0.06%|                    |      2/56547[0.00%]|

       4986457030656|                 0.03%|                    db file compact read|           1|       0.03%|                    |      1/56547[0.00%]|

        176093659136|                 0.03%|                  default condition wait|           1|       0.03%|                    |      1/56547[0.00%]|

       4969277161472|                 0.03%|               slog flush condition wait|           1|       0.03%|                    |      1/56547[0.00%]|

       5381594021888|                 0.03%|                              sleep wait|           1|       0.03%|                    |      1/56547[0.00%]|

       4930622455808|                 0.03%|                    db file compact read|           1|       0.03%|                    |      1/56547[0.00%]|

--------------------+----------------------+----------------------------------------+------------+------------+--------------------+--------------------+
```

### Top latches

这部分显示顶级闩锁（latches）的信息。

* Latch: 显示闩锁的名称。
* Sampled Count: 显示在采样期间记录到的该闩锁的数量。
* % Activity: 显示该闩锁的活动百分比，表示该闩锁在总活动时间中所占的比例。

这些信息提供了关于顶级闩锁的统计数据，包括闩锁名称、采样计数以及活动百分比。

<main id="notice" type='explain'>
  <h4>说明</h4>
  <p>闩锁是简单的低级序列化机制，用于保护系统全局区中的共享数据结构。<br>
例如，锁存器保护当前访问数据库的用户列表和描述缓冲区缓存中块的数据结构。服务器或后台进程在操作或查看这些结构之一时会在很短的时间内获取闩锁。锁存器的实现依赖于操作系统，特别是关于进程是否等待锁存器以及等待多长时间。</p>
</main>

```shell
## Top latches:

----------------------------------------------------------------+--------------------+--------------------+

                                                           Latch|       Sampled Count|          % Activity|

----------------------------------------------------------------+--------------------+--------------------+

                                        latch: ls meta lock wait|                   2|               0.06%|

----------------------------------------------------------------+--------------------+--------------------+

```

### Node Load

这部分显示了有关节点负载情况的信息。

* SVR IP: 显示服务器 IP 地址。

* SVR PORT: 显示服务器端口号。

* Sampled Count: 显示采样计数，表示采样期间收集到的活跃会话的数量。

* Idle Wait Count: 显示空闲等待计数，表示在采样期间记录到的处于空闲等待状态的会话数量。

* Load: 显示节点负载，表示活跃会话的负载情况。负载值越高，表示节点负载越重。

这些信息提供了对节点在给定采样期间的负载情况的快照。通过监视并分析节点的负载情况，可以评估系统性能和资源使用情况，并进行性能优化和调整。

```shell
## Node Load:

----------------------------------------+--------------------+--------------------+--------------------+------------------------------+

                                  SVR IP|            SVR PORT|       Sampled Count|     Idle Wait Count|                          Load|

----------------------------------------+--------------------+--------------------+--------------------+------------------------------+

                             xx.xx.xx.xx|                2882|                3374|                   6|                          0.06|

----------------------------------------+--------------------+--------------------+--------------------+------------------------------+
```

## 相关等待事件

根据 [常见的等待事件](../../../../700.reference/700.system-views/520.wait-event-description.md) 查询各等待事件表示的含义，方便您在分析报告时，快速的定位问题，

## 相关文档

* [ASH 简介](../500.ash-report-diagnosis/100.ash-introduction.md)。
* [生成 ASH 报告](../500.ash-report-diagnosis/200.generate-ash-report.md)。
