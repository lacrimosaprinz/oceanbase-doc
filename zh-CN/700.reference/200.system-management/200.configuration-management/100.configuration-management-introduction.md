|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||

# 配置管理介绍

OceanBase 数据库通过设置配置项和系统变量来完成配置管理。

## 配置项

配置项主要用于运维，常用于控制机器及其以上级别的系统行为。可以作为节点启动参数和租户创建参数，也可以在节点运行时进行修改以调整系统行为。
有关配置项的详细介绍请参见 [设置参数](../200.configuration-management/200.set-parameters.md)。

## 系统变量

系统变量通常和用户 Session 绑定，用于控制 Session 级别的 SQL 行为。

支持设置 Global 和 Session 级别的变量。设置 Global 级别的系统变量后，当前 Session 上不会生效，新建的任何 Session 都能读到新的变量值。设置 Session 级别的系统变量后，仅对当前 Session 生效。

有关系统变量的详细介绍请参见 [设置变量](../200.configuration-management/300.set-variables.md)。

## 系统配置项和系统变量对比

| 对比项  |                                                                                                                                                                                   系统配置项                                                                                                                                                                                   |                                                                                                                                                                                                                            系统变量                                                                                                                                                                                                                             |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 生效范围 | 集群、租户、Zone、机器。                                                                                                                                                                                                                                                                                                                                                            | 租户的 Global 级别或 Session 级别。                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| 生效方式 | <ul><li>动态生效：`edit_level` 为`dynamic_effective`。</li><li>重启生效：`edit_level` 为 `static_effective`。</li></ul>                                                                                                                                                                                                  | <ul><li>设置 Session 级别的变量仅对当前 Session 有效，对其他 Session 无效。</li><li>设置 Global 级别的变量对当前 Session 无效，需要重新登录建立新的 Session 才会生效。</li></ul>                                                                                                                                                                                                                                                             |
| 修改方式 | <ul><li>支持通过 SQL 语句修改，示例如下：<br> `obclient> Alter SYSTEM SET schema_history_expire_time='1h';` </li><li>支持通过启动参数修改，示例如下：<br> `cd /home/admin && ./bin/observer -o "schema_history_expire_time='1h'"`   </li></ul> | 仅支持通过 SQL 语句修改，示例如下： <ul><li>MySQL 模式<br> `obclient> SET ob_query_timeout = 20000000;`<br> `obclient> SET GLOBAL ob_query_timeout = 20000000;`</li><li>Oracle 模式<br>`obclient> SET ob_query_timeout = 20000000;` <br>`obclient> SET GLOBAL ob_query_timeout = 20000000; `<br> `obclient> ALTER SESSION SET ob_query_timeout = 20000000;`<br> `obclient> ALTER SYSTEM SET ob_query_timeout = 20000000;`</li></ul> |
| 持久化  | 持久化到内部表与配置文件，可以在 `/home/admin/oceanbase/etc/observer.config.bin` 与 `/home/admin/oceanbase/etc/observer.config.bin.history` 文件中查询该配置项。                                                                                                                                                                                                                                     | 仅 GLOBAL 级别的变量会持久化，SESSION 级别的变量不会进行持久化。                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 生命周期 | 长，从进程启动到退出。                                                                                                                                                                                                                                                                                                                                                               | 短，需要租户的 Schema 创建成功以后才生效。                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 查询方式 | 可以使用 `SHOW PARAMETERS` 语句查询。示例如下：<br>`obclient> SHOW PARAMETERS LIKE 'schema_history_expire_time';`                                                                                                                                                                                                                                                                                                                                              | 可以使用 `SHOW [GLOBAL] VARIABLES` 或 `SELECT` 语句查询。 示例如下：<ul><li>MySQL 模式<br>`obclient> SHOW VARIABLES LIKE 'ob_query_timeout';`<br> `obclient> SHOW GLOBAL VARIABLES LIKE 'ob_query_timeout';` <br>`obclient> SELECT * FROM INFORMATION_SCHEMA.SESSION_VARIABLES WHERE VARIABLE_NAME = 'ob_query_timeout';`<br>`obclient> SELECT * FROM INFORMATION_SCHEMA.GLOBAL_VARIABLES WHERE VARIABLE_NAME = 'ob_query_timeout';` </li><li>Oracle 模式<br>`obclient> SHOW VARIABLES LIKE 'ob_query_timeout';`<br> `obclient> SHOW GLOBAL VARIABLES LIKE 'ob_query_timeout';` <br>`obclient> SELECT * FROM SYS.TENANT_VIRTUAL_GLOBAL_VARIABLE WHERE VARIABLE_NAME = 'ob_query_timeout';`<br>`obclient> SELECT * FROM SYS.TENANT_VIRTUAL_SESSION_VARIABLE WHERE VARIABLE_NAME = 'ob_query_timeout';`</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                    |

