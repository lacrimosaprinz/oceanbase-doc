|description||
|------|------|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|MySQL Mode|

# 更改复制表属性

OceanBase 数据库中通过 `DUPLICATE_SCOPE` 参数来指定复制表的属性。表创建成功后，可以通过修改 `DUPLICATE_SCOPE` 参数的值来实现复制表与普通表之间的相互转换。

## 使用限制及注意事项

* 在进行复制表的转换时，如果当前租户有扩缩容、Primary Zone 变更以及 Locality 变更等行为触发了负载均衡任务，则复制表属性的转换任务需要等待当前均衡任务完成。

* 由于复制表与表组互斥，在将普通表转换为复制表时，如果待转换的普通表属于某个表组，则该普通表无法转换为复制表。

* 复制表的转换依赖租户的负载均衡及 Transfer 功能，当租户级配置项 `enable_rebalance`、`enable_transfer` 以及 `enable_rereplication` 中任意一个配置项的值为 `false` 即关闭状态时，均无法进行复制表的转换操作。如果修改配置项 `enable_rebalance`、`enable_transfer` 的值为 `false` 时，有正在执行的复制表转换任务，则对应的复制表转换任务会被取消。

## 前提条件

在进行复制表的转换操作前，请确认以下配置项的值已设置为 `True`：

* `enable_rebalance`

  租户级配置项 `enable_rebalance` 在系统租户下用于控制是否进行租户间的负载均衡；在用户租户下用于控制是否进行租户内均衡。默认值为 `True`。有关配置项 `enable_rebalance` 的详细说明及设置，请参见 [enable_rebalance](../../../800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/6700.enable_rebalance.md)。

* `enable_transfer`

  租户级配置项 `enable_transfer` 用于控制是否在租户下进行 Transfer，默认值为 `True`。有关配置项  `enable_transfer` 的详细说明及设置，请参见 [enable_transfer](../../../800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/25600.enable_transfer.md)。

* `enable_rereplication`

  集群级配置项 `enable_rereplication` 用于设置是否开启自动补副本的功能。默认值为 `True`。有关配置项 `enable_rereplication` 的详细说明及设置，请参见 [enable_rereplication](../../../800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/8200.enable_rereplication.md)。

## 更改复制表属性语法

更改复制表属性的 SQL 语句如下：

```sql
ALTER TABLE table_name DUPLICATE_SCOPE= 'none | cluster';
```

语句中：

* `none`：表示将当前表转换为普通表。
* `cluster`：表示将当前表转换为复制表。

假设当前数据库中已创建复制表 `dup_t1`。

```sql
obclient [test]> CREATE TABLE dup_t1 (c1 int,c2 int) DUPLICATE_SCOPE= 'cluster';
```

将该复制表转换为普通表的示例如下：

```sql
ALTER TABLE dup_t1 DUPLICATE_SCOPE= 'none';
```

## 相关文档

[创建表](200.create-a-table-for-mysql-tenant-of-mysql-mode.md)
