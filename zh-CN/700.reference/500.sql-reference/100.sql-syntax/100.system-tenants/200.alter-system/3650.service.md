| Description   |                 |
|---------------|-----------------|
| keywords      |                 |
| dir-name      |                 |
| dir-name-en   |                 |
| tenant-type   |                 |

# SERVICE

## 描述

该语句用于维护 `SERVICE_NAME`，控制 `SERVICE_NAME` 的创建、删除、启动和停止等操作。

<main id="notice" type='explain'>
  <h4>说明</h4>
  <p>主备租户创建相同的 <code>SERVICE_NAME</code>，在连接串中指定 <code>SERVICE_NAME</code> 可以实现自动路由到主租户。</p>
</main>

## 使用限制及注意事项

* `META`/`SYS` 租户不支持 `SERVICE_NAME` 功能。
* OCP 保证了在其管理的集群范围内，一个 `SERVICE_NAME` 下只能有一个主租户，用户黑屏设置 `SERVICE_NAME` 需要自行保证。
* `FAILOVER` 操作自动删除租户下所有 `SERVICE_NAME`。
* 当前版本一个租户最多有一个 `SERVICE_NAME`。
* 通过 `SERVICE_NAME` 建立的连接，不允许执行 `SERVICE_NAME` 和租户主备角色转换有关运维命令。
* 暂时不支持租户下的 `SERVICE_NAME` 与 `CONSUMER GROUP` 绑定。

## 权限要求

执行该语句的用户需要拥有 `ALTER SYSTEM` 权限。有关 OceanBase 数据库权限的详细介绍，请参见 [MySQL 模式下的权限分类](../../../../../600.manage/500.security-and-permissions/300.access-control/200.user-and-permission/200.permission-of-mysql-mode/100.permission-classification-of-mysql.md) 和 [Oracle 模式下的权限分类](../../../../../600.manage/500.security-and-permissions/300.access-control/200.user-and-permission/300.permission-of-oracle-mode/000.permission-classification-of-oracle-mode.md)。

## 语法

```sql
ALTER SYSTEM {CREATE | DELETE | START | STOP} SERVICE service_name [tenant = 'tenant_name'];
```

## 参数解释

|    **参数**   |      **描述**      |
|---------------|--------------------|
| CREATE        | 创建服务。创建服务后，自动启动服务。|
| DELETE        | 删除服务。删除服务前，服务需要已经被停止。|
| START         | 启动服务。启动服务后，可以通过本 `SERVICE_NAME` 建 Session 或者允许请求。|
| STOP          | 停止服务。停止服务后，既不存在通过该 `SERVICE_NAME` 启动的 Session，也不能通过该 `SERVICE_NAME` 建立新的 Session。|
| service_name  | 指定服务名称。|
| tenant_name   | 可选项，指定待操作的租户。如果不显示指定待操作的租户，则默认租户名为当前租户。<main id="notice" type='notice'><h4>注意</h4><p>系统租户不支持 <code>SERVICE_NAME</code> 功能，即在系统租户下执行时该语句时，必须指定 <code>TENANT = tenant_name</code> 子句。</p></main>|

## 示例

为租户 `mysql001` 创建服务 `service_mysql001`。

```sql
ALTER SYSTEM CREATE SERVICE service_mysql001 TENANT = 'mysql001';
```

## 相关文档

* 在用户租户下通过视图 `DBA_OB_SERVICES` 或者系统租户下通过视图 `CDB_OB_SERVICES` 查询租户的 `SERVICE_NAME` 及其状态信息。

* 在用户租户下通过视图 `DBA_OB_TENANT_EVENT_HISTORY` 或者系统租户下通过视图 `CDB_OB_TENANT_EVENT_HISTORY` 指定 `MODULE` 为 `SERVICE NAME` 查询 `SERVICE_NAME` 有关运维命令的执行情况。
1