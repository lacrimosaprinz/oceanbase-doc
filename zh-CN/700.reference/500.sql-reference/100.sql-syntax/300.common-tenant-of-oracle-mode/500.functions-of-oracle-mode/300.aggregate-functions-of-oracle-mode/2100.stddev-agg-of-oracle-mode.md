| Description   |                 |
|---------------|-----------------|
| keywords      |                 |
| dir-name      |                 |
| dir-name-en   |                 |
| tenant-type   | Oracle Mode     |

# STDDEV

## 描述

该函数用于计算一组数值型数据标准差。它与函数 `STDDEV_SAMP` 的不同之处在于，`STDDEV` 只有一行输入数据时返回 `0`，而 `STDDEV_SAMP` 返回 NULL。OceanBase 数据库中标准差的值是函数 `VARIANCE` 计算出的方差的算术平方根。可以将其用作聚合或分析函数。

  <main id="notice" type='explain'>
    <h4>说明</h4>
    <ul>
    <li>作为分析函数使用时，需要使用 <code>OVER</code> 子句定义窗口进行计算。它对一组行的集合进行计算并返回多个值。</li>
    <li>作为聚合函数使用时，该函数对一组行的集合进行聚合计算，结果只能返回一个值，此时不需要加 <code>OVER</code> 子句。</li>
    </ul>
  </main>

## 语法

```sql
STDDEV([ DISTINCT | UNIQUE | ALL ] expr) [ OVER (analytic_clause) ]
```

## 参数解释

|            参数             |                                                                                                                         说明                                                                                                                          |
|---------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| DISTINCT \| UNIQUE \| ALL | 查询时是否去重。为可选项，默认值 `ALL`。 <ul><li> `ALL`：全部数值列。   </li><li> `DISTINCT`：去重关键字，表示计算唯一值的总体标准差。  </li><li> `UNIQUE`：去重关键字，表示计算唯一值的总体标准差。</li></ul>    |
| expr                      | 数值类型或者可以转换成数值类型的值。                                                                                                                                                                                                                                  |
| OVER                      | 使用 `OVER` 子句定义窗口进行计算。详细信息请参见 [分析函数说明](../400.analysis-functions-of-oracle-mode/100.window-function-description-of-oracle-mode.md)。                                                                                                                                                             |

  <main id="notice" type='notice'>
    <h4>注意</h4>
    <p>如果您指定了 <code>DISTINCT</code> 或 <code>UNIQUE</code> 关键字，则 <code>analytic_clause</code> 中不允许出现 <code>order_by_clause</code> 和 <code>windowing_clause</code>。</p>
  </main>

## 返回类型

返回 `NUMBER` 类型的数据。

## 示例

现有已创建的表`employees`。

```sql
obclient> SELECT * FROM employees;
+---------------+-----------+------------+--------+
| DEPARTMENT_ID | LAST_NAME | HIREDATE   | SALARY |
+---------------+-----------+------------+--------+
|            30 | Raphaely  | 2017-07-01 |   1700 |
|            30 | De Haan   | 2018-05-01 |  11000 |
|            40 | Errazuriz | 2017-07-21 |   1400 |
|            50 | Hartstein | 2019-10-05 |  14000 |
|            50 | Raphaely  | 2017-07-22 |   1700 |
|            50 | Weiss     | 2019-10-05 |  13500 |
|            90 | Russell   | 2019-07-11 |  13000 |
|            90 | Partners  | 2018-12-01 |  14000 |
+---------------+-----------+------------+--------+
8 rows in set
```

### 聚合函数示例

计算列 `salary` 的标准差。

```sql
obclient> SELECT STDDEV(salary) FROM employees;
+-------------------------------------------+
| STDDEV(SALARY)                            |
+-------------------------------------------+
| 6026.474330580265330900400184969999384459 |
+-------------------------------------------+
1 row in set
```

### 分析函数示例

按列 `hiredate` 升序排序，计算列 `salary` 的累计标准差。

```sql
obclient> SELECT last_name,hiredate,salary,STDDEV(salary) OVER (ORDER BY hiredate) "StdDev"
          FROM employees;
+-----------+------------+--------+-------------------------------------------+
| LAST_NAME | HIREDATE   | SALARY | StdDev                                    |
+-----------+------------+--------+-------------------------------------------+
| Raphaely  | 2017-07-01 |   1700 |                                         0 |
| Errazuriz | 2017-07-21 |   1400 |  212.132034355964257320253308631454711785 |
| Raphaely  | 2017-07-22 |   1700 |  173.205080756887729352744634150587236694 |
| De Haan   | 2018-05-01 |  11000 | 4702.127178203498995615489088200868644482 |
| Partners  | 2018-12-01 |  14000 | 6064.899009876421676804205219406952308814 |
| Russell   | 2019-07-11 |  13000 |  6138.94670661561181357873224397795992899 |
| Hartstein | 2019-10-05 |  14000 | 6026.474330580265330900400184969999384459 |
| Weiss     | 2019-10-05 |  13500 | 6026.474330580265330900400184969999384459 |
+-----------+------------+--------+-------------------------------------------+
8 rows in set
```
