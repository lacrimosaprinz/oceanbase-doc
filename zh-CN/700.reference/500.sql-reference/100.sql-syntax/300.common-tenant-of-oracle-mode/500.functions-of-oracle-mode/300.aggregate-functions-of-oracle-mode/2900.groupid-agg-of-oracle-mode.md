| Description   |                 |
|---------------|-----------------|
| keywords      |                 |
| dir-name      |                 |
| dir-name-en   |                 |
| tenant-type   | Oracle Mode     |

# GROUP_ID

## 描述

`GROUP_ID` 函数用于返回与 `GROUP BY` 子句中的重复组相关联的唯一标识符。它通常用在含有 `ROLLUP` 或 `CUBE` 操作的查询中，用于区分产生相同分组集的不同行。

## 使用限制及注意事项

- `GROUP_ID` 不能用于 `WHERE` 子句、连接条件、聚合函数内部或分组属性的定义中。

- `GROUP_ID` 函数返回的是一个数字，指示分组集在查询结果中的出现次数。
- 使用 `GROUP_ID` 时不需要任何参数。

## 语法

```sql
GROUP_ID()
```

## 示例

创建一个数据表 `sales_data`，包含 `year`、`quarter`、`region` 和 `sales_amount` 四个字段。

```sql
obclient > CREATE TABLE sales_data (
    ->     year INT,
    ->     quarter INT,
    ->     region VARCHAR(50),
    ->     sales_amount DECIMAL(10, 2)
    -> );
```

然后，向表 `sales_data` 中插入一些数据。

```sql
obclient > INSERT INTO sales_data (year, quarter, region, sales_amount) VALUES
    -> (2020, 1, 'North', 1000.00),
    -> (2020, 1, 'South', 1500.00),
    -> (2020, 2, 'North', 1200.00),
    -> (2020, 2, 'South', 1300.00),
    -> (2021, 1, 'North', 1400.00),
    -> (2021, 1, 'South', 1100.00),
    -> (2021, 2, 'North', 1600.00),
    -> (2021, 2, 'South', 1700.00);
```

在这个表中使用 `GROUP BY` 与 `ROLLUP` 函数来得到各年份、季度和地区的销售总额，并使用 `GROUP_ID` 来标识重复的分组。

```sql
obclient > SELECT
    ->     year,
    ->     quarter,
    ->     region,
    ->     SUM(sales_amount) AS total_sales,
    ->     GROUP_ID() AS group_id
    -> FROM
    ->     sales_data
    -> GROUP BY
    ->     year,
    ->     ROLLUP(quarter, region)
    -> ORDER BY
    ->     year,
    ->     quarter,
    ->     region;
```

返回结果如下：

```shell
+------+---------+--------+-------------+----------+
| YEAR | QUARTER | REGION | TOTAL_SALES | GROUP_ID |
+------+---------+--------+-------------+----------+
| 2020 |       1 | North  |        1000 |        0 |
| 2020 |       1 | South  |        1500 |        0 |
| 2020 |       1 | NULL   |        2500 |        0 |
| 2020 |       2 | North  |        1200 |        0 |
| 2020 |       2 | South  |        1300 |        0 |
| 2020 |       2 | NULL   |        2500 |        0 |
| 2020 |    NULL | NULL   |        5000 |        0 |
| 2021 |       1 | North  |        1400 |        0 |
| 2021 |       1 | South  |        1100 |        0 |
| 2021 |       1 | NULL   |        2500 |        0 |
| 2021 |       2 | North  |        1600 |        0 |
| 2021 |       2 | South  |        1700 |        0 |
| 2021 |       2 | NULL   |        3300 |        0 |
| 2021 |    NULL | NULL   |        5800 |        0 |
+------+---------+--------+-------------+----------+
14 rows in set
```

# GROUPING_ID 函数

## 功能描述

`GROUPING_ID` 函数是一个聚合函数，用于计算一组表达式的组合值，这在使用 `GROUP BY` 与 `ROLLUP` 或 `CUBE` 操作时非常有用。

## 语法

```sql
GROUPING_ID(expr1, expr2, ..., exprN)
```
- `expr1, expr2, ..., exprN`：要计算其组合值的表达式列表。

## 使用示例

```sql
SELECT department_id, job_id, GROUPING_ID(department_id, job_id)
FROM employees
GROUP BY ROLLUP(department_id, job_id);
```

## 注意事项

- 当某个表达式在分组集中时，`GROUPING_ID` 返回的值会增加；如果不在，则保持不变。

## 兼容性说明

此函数旨在与 Oracle 数据库中的 `GROUPING_ID` 函数保持兼容。如果存在任何差异，请在此节详细描述。


在实际的文档中，这些部分会更详细，并且可能还包括更多的信息，例如相关的错误消息、性能优化提示等。
