| Description   |                 |
|---------------|-----------------|
| keywords      |                 |
| dir-name      |                 |
| dir-name-en   |                 |
| tenant-type   | Oracle Mode     |

# MAX

## 描述

该函数返回参数中指定的列中的最大值。可以将其用作聚合或分析函数。

  <main id="notice" type='explain'>
    <h4>说明</h4>
    <ul>
    <li>作为分析函数使用时，需要使用 <code>OVER</code> 子句定义窗口进行计算。它对一组行的集合进行计算并返回多个值。</li>
    <li>作为聚合函数使用时，该函数对一组行的集合进行聚合计算，结果只能返回一个值，此时不需要加 <code>OVER</code> 子句。</li>
    </ul>
  </main>

## 语法

```sql
MAX ([ DISTINCT | UNIQUE | ALL ] expr) [ OVER (analytic_clause) ]
```

## 参数解释

|            参数             |                                                                                                                                           说明                                                                                                                                            |
|---------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| DISTINCT \| UNIQUE \| ALL | 查询时是否去重。为可选项，默认值 `ALL`。 <ul><li> `ALL`：返回所有值，包含重复行，且忽略值为 `NULL` 的行。  </li><li> `DISTINCT`：返回的行中去除重复行，且忽略值为 `NULL` 的行。   </li><li> `UNIQUE`：返回的行中去除重复行，且忽略值为 `NULL` 的行。 </li></ul>   |
| expr                      | 可为数值、字符、日期型或其它类型的数据列或表达式。                                                                                                                                                                                                                                                               |
| OVER                      | 使用 `OVER` 子句定义窗口进行计算。详细信息请参见 [分析函数说明](../400.analysis-functions-of-oracle-mode/100.window-function-description-of-oracle-mode.md)。                                                                                                                                                                                                 |

## 返回类型

返回与 `expr` 相同的数据类型值。

## 示例

现有已创建的表 `employees`。

```sql
obclient> SELECT * FROM employees;
+---------------+------------+-----------+------------+--------+
| DEPARTMENT_ID | MANAGER_ID | LAST_NAME | HIREDATE   | SALARY |
+---------------+------------+-----------+------------+--------+
|            30 |        100 | Raphaely  | 2017-07-01 |   1700 |
|            30 |        100 | De Haan   | 2018-05-01 |  11000 |
|            40 |        100 | Errazuriz | 2017-07-21 |   1400 |
|            50 |        100 | Hartstein | 2019-10-05 |  14000 |
|            50 |        100 | Raphaely  | 2017-07-22 |   1700 |
|            50 |        100 | Weiss     | 2019-10-05 |  13500 |
|            90 |        100 | Russell   | 2019-07-11 |  13000 |
|            90 |        100 | Partners  | 2018-12-01 |  14000 |
+---------------+------------+-----------+------------+--------+
8 rows in set
```

### 聚合函数示例

查询 `salary` 列的最大值。

```sql
obclient> SELECT MAX(salary) FROM employees;
+-------------+
| MAX(SALARY) |
+-------------+
|       14000 |
+-------------+
1 row in set
```

### 分析函数示例

以 `department_id` 分组，查询 `salary` 列的最大值。

```sql
obclient> SELECT department_id,last_name,salary,
                 MAX(salary) OVER (PARTITION BY department_id) AS rmax_sal
          FROM employees;
+---------------+-----------+--------+----------+
| DEPARTMENT_ID | LAST_NAME | SALARY | RMAX_SAL |
+---------------+-----------+--------+----------+
|            30 | Raphaely  |   1700 |    11000 |
|            30 | De Haan   |  11000 |    11000 |
|            40 | Errazuriz |   1400 |     1400 |
|            50 | Hartstein |  14000 |    14000 |
|            50 | Raphaely  |   1700 |    14000 |
|            50 | Weiss     |  13500 |    14000 |
|            90 | Russell   |  13000 |    14000 |
|            90 | Partners  |  14000 |    14000 |
+---------------+-----------+--------+----------+
8 rows in set
```
