| Description   |                 |
|---------------|-----------------|
| keywords      |                 |
| dir-name      |                 |
| dir-name-en   |                 |
| tenant-type   | Oracle Mode     |

# MEDIAN

## 描述

该函数用于返回一组数值的中值，即将一组数值排序后返回居于中间的数值。如果参数集合中包含偶数个数值，该函数将返回位于中间的两个数的平均值。可以将其用作聚合或分析函数。

  <main id="notice" type='explain'>
    <h4>说明</h4>
    <ul>
    <li>作为分析函数使用时，需要使用 <code>OVER</code> 子句定义窗口进行计算。它对一组行的集合进行计算并返回多个值。</li>
    <li>作为聚合函数使用时，该函数对一组行的集合进行聚合计算，结果只能返回一个值，此时不需要加 <code>OVER</code> 子句。</li>
    </ul>
  </main>

## 语法

```sql
MEDIAN(expr) [ OVER (query_partition_clause) ]
```

## 参数解释

|  参数  |                                           说明                                            |
|------|-----------------------------------------------------------------------------------------|
| expr | 指定要求中值的数组名称，参数类型属于数值数据类型或可以隐式转换为数字数据类型。                                                 |
| OVER | 使用 `OVER` 子句定义窗口进行计算。详细信息请参见 [分析函数说明](../400.analysis-functions-of-oracle-mode/100.window-function-description-of-oracle-mode.md)。 |

## 返回类型

* 如果仅指定 `expr`，则该函数返回与参数的数值数据类型相同的数据类型。

* 如果指定 `OVER` 子句，则数据库确定具有最高数值优先级的参数，将其余参数隐式转换为该数据类型，并返回该数据类型。

## 示例

创建表 `tbl1`，并插入数据。

```sql
obclient> CREATE TABLE tbl1(col1 INT,col2 varchar(10),col3 INT,col4 INT);
Query OK, 0 rows affected

obclient> INSERT INTO tbl1 VALUES(1,'A1',8,12),(1,'A2',10,15),(1,'A3',11,16),
            (2,'B1',9,14),(2,'B2',10,15),(2,'B3',8,13),(2,'B4',11,16),(3,'C1',8,18),
            (3,'C2',9,16),(3,'C3',10,15),(3,'C4',11,12),(3,'C5',12,10);
Query OK, 12 rows affected
Records: 12  Duplicates: 0  Warnings: 0

obclient> SELECT * FROM tbl1;
+------+------+------+------+
| COL1 | COL2 | COL3 | COL4 |
+------+------+------+------+
|    1 | A1   |    8 |   12 |
|    1 | A2   |   10 |   15 |
|    1 | A3   |   11 |   16 |
|    2 | B1   |    9 |   14 |
|    2 | B2   |   10 |   15 |
|    2 | B3   |    8 |   13 |
|    2 | B4   |   11 |   16 |
|    3 | C1   |    8 |   18 |
|    3 | C2   |    9 |   16 |
|    3 | C3   |   10 |   15 |
|    3 | C4   |   11 |   12 |
|    3 | C5   |   12 |   10 |
+------+------+------+------+
12 rows in set
```

### 聚合函数示例

计算列 `col4` 的中值。

```sql
obclient> SELECT MEDIAN(col4) FROM tbl1;
+--------------+
| MEDIAN(COL4) |
+--------------+
|           15 |
+--------------+
1 row in set
```

### 分析函数示例

按列 `col1` 分组，计算列 `col4` 的中值。

```sql
obclient> SELECT col1,col4,MEDIAN(col4) OVER(PARTITION BY col1) "MEDIAN"
 FROM tbl1;
+------+------+--------+
| COL1 | COL4 | MEDIAN |
+------+------+--------+
|    1 |   12 |     15 |
|    1 |   15 |     15 |
|    1 |   16 |     15 |
|    2 |   14 |   14.5 |
|    2 |   15 |   14.5 |
|    2 |   13 |   14.5 |
|    2 |   16 |   14.5 |
|    3 |   18 |     15 |
|    3 |   16 |     15 |
|    3 |   15 |     15 |
|    3 |   12 |     15 |
|    3 |   10 |     15 |
+------+------+--------+
12 rows in set
```
