| Description   |                 |
|---------------|-----------------|
| keywords      |                 |
| dir-name      |                 |
| dir-name-en   |                 |
| tenant-type   | Oracle Mode     |

# ASH_REPORT

`ASH_REPORT` 过程用于以文本形式显示 ASH 报告。

  <main id="notice" >
    <h4>功能适用性</h4>
    <p>该内容仅适用于 OceanBase 数据库企业版。OceanBase 数据库社区版仅提供 MySQL 模式。</p>
  </main>

## 语法

```sql
 PROCEDURE ASH_REPORT(BTIME         IN DATE,
                       ETIME         IN DATE,
                       SQL_ID        IN VARCHAR2  DEFAULT NULL,
                       TRACE_ID      IN VARCHAR2  DEFAULT NULL,
                       WAIT_CLASS    IN VARCHAR2  DEFAULT NULL,
                       REPORT_TYPE   IN VARCHAR2  DEFAULT 'text'
                       SVR_IP        IN VARCHAR2  DEFAULT NULL,
                       SVR_PORT      IN NUMBER    DEFAULT NULL
                     );
```

## 参数说明

| **参数** | **说明** |
| --- | --- |
| BTIME | 采样开始时间。 |
| ETIME | 采样结束时间。 |
| SQL_ID | 待采样 SQL 的 `SQL_ID`，不填或填 `NULL` 则表示不限制 `SQL_ID`。 |
| TRACE_ID | 待采样 SQL 的 `TRACE_ID`，不填或填 `NULL` 则表示不限制 `TRACE_ID`。 |
| WAIT_CLASS | 待采样的事件类型。`WAIT_CLASS` 取值参考 `GV$ACTIVE_SESSION_HISTORY.WAIT_CLASS` 字段的取值，不填或填 `NULL` 则表示不限制等待类型。 |
| REPORT_TYPE | 报告类型，目前仅支持 `TEXT` 类型，可不填写。 |
| SVR_IP | 用于指定生成 ASH Report 的节点 IP。 |
| SVR_PORT | 用于指定生成 ASH Report 的节点端口。|

## 使用说明

获取 ASH 相关信息需要查询 `oceanbase.GV$ACTIVE_SESSION_HISTORY` 视图获取。

## 示例

启用服务器输出。

```sql
obclient> SET SERVEROUTPUT ON;
```

调用 `ASH_REPORT`，输入需要诊断的开始时间和结束时间。执行后，ASH 报告信息将显示在界面上。

```shell
obclient> CALL DBMS_WORKLOAD_REPOSITORY.ASH_REPORT(to_date('2024-02-22 19:26:47', 'yyyy-MM-dd HH24:mi:ss'),to_date('2024-05-22 19:27:07', 'yyyy-MM-dd HH24:mi:ss'), NULL, NULL, NULL, 'text', '172.30.xxx.xxx', 28xx);
```

示例输出结果如下：

```sql
# ASH Report
----
           Sample Begin: 2024-02-22 19:26:47
             Sample End: 2024-05-22 19:27:07
             ----------
    Analysis Begin Time: 2024-04-09 18:11:18
      Analysis End Time: 2024-04-10 10:45:53
           Elapsed Time: 59675(secs)
          Num of Sample: 3585
          Num of Events: 3585
Average Active Sessions: 0.060
----

## Top User Events:
----------------------------------------------------------------+--------------------+---------+
                                                           Event|          WAIT_CLASS|  % Event|
----------------------------------------------------------------+--------------------+---------+
                                              CPU + Wait for CPU|               OTHER|   92.50%|
                                                      palf write|           SYSTEM_IO|    4.04%|
                                       slog flush condition wait|         CONCURRENCY|    1.09%|
                                           db file compact write|           SYSTEM_IO|    0.86%|
                                  async rpc proxy condition wait|             NETWORK|    0.36%|
                                             exec inner sql wait|               OTHER|    0.31%|
                               wait for network request in queue|             NETWORK|    0.22%|
                                                      sleep wait|                IDLE|    0.17%|
                                            db file compact read|           SYSTEM_IO|    0.11%|
                                                       palf read|           SYSTEM_IO|    0.11%|
                                                        sync rpc|             NETWORK|    0.08%|
                                          default condition wait|         CONCURRENCY|    0.08%|
                                        latch: ls meta lock wait|         CONCURRENCY|    0.06%|
----------------------------------------------------------------+--------------------+---------+

## Top Events P1/P2/P3 Value:
----------------------------------------------------------------+----------+------------+--------------------------------------------------+--------------------+--------------------+--------------------+
                                                           Event|   % Event|  % Activity|                                      Max P1/P2/P3|         Parameter 1|         Parameter 2|         Parameter 3|
----------------------------------------------------------------+----------+------------+--------------------------------------------------+--------------------+--------------------+--------------------+
                                              CPU + Wait for CPU|    92.50%|     92.497%|                                       "0","0","0"|                    |                    |                    |
                                                      palf write|     4.04%|      4.045%|                           "406","66957312","8192"|                  fd|              offset|                size|
                                       slog flush condition wait|     1.09%|      1.088%|                         "140458332257256","0","0"|             address|                    |                    |
                                           db file compact write|     0.86%|      0.865%|                                    "8192","0","0"|                  fd|              offset|                size|
                                  async rpc proxy condition wait|     0.36%|      0.363%|                         "140454242609688","0","0"|             address|                    |                    |
                                             exec inner sql wait|     0.31%|      0.307%|                          "50004","3221742313","0"|wait inner sql class|    inner session id|                    |
                               wait for network request in queue|     0.22%|      0.223%|                                    "5387","0","2"|               pcode|               level|            priority|
                                                      sleep wait|     0.17%|      0.167%|                                 "5000000","0","0"|      sleep_interval|                    |                    |
                                            db file compact read|     0.11%|      0.112%|                                     "387","0","0"|                  fd|              offset|                size|
----------------------------------------------------------------+----------+------------+--------------------------------------------------+--------------------+--------------------+--------------------+

## Top Phase of Execution:
----------------------------------------+------------+--------------+----------------------------------------+
                      Phase of Execution|  % Activity|  Sample Count|                     Avg Active Sessions|
----------------------------------------+------------+--------------+----------------------------------------+
                         IN_STORAGE_READ|      0.167%|             6|                                    0.00|
                           IN_COMMITTING|      0.139%|             5|                                    0.00|
                         IN_SQL_OPTIMIZE|      0.056%|             2|                                    0.00|
                        IN_SQL_EXECUTION|      0.056%|             2|                                    0.00|
                        IN_STORAGE_WRITE|      0.028%|             1|                                    0.00|
                                IN_PARSE|      0.000%|             0|                                    0.00|
                             IN_PL_PARSE|      0.000%|             0|                                    0.00|
                           IN_PLAN_CACHE|      0.000%|             0|                                    0.00|
                         IN_PX_EXECUTION|      0.000%|             0|                                    0.00|
                        IN_SEQUENCE_LOAD|      0.000%|             0|                                    0.00|
                 IN_REMOTE_DAS_EXECUTION|      0.000%|             0|                                    0.00|
----------------------------------------+------------+--------------+----------------------------------------+

## Top SQL with Top Events
 - All events included.
 - Empty 'SQL Text' if it is PL/SQL query
----------------------------------------+------------+-------------------------+----------------------------------------------------------------+------------+------------------------------------------------------------+
                                  SQL ID|     PLAN ID|  Sampled # of Executions|                                                           Event|     % Event|                                                    SQL Text|
----------------------------------------+------------+-------------------------+----------------------------------------------------------------+------------+------------------------------------------------------------+
                                        |           0|                     3309|                                              CPU + Wait for CPU|      92.30%|                                                            |
                                        |           0|                      145|                                                      palf write|       4.04%|                                                            |
                                        |           0|                       39|                                       slog flush condition wait|       1.09%|                                                            |
                                        |           0|                       31|                                           db file compact write|       0.86%|                                                            |
                                        |           0|                       13|                                  async rpc proxy condition wait|       0.36%|                                                            |
                                        |           0|                       11|                                             exec inner sql wait|       0.31%|                                                            |
                                        |           0|                        8|                               wait for network request in queue|       0.22%|                                                            |
                                        |           0|                        6|                                                      sleep wait|       0.17%|                                                            |
        945096BAD4B3B7C7DA87D4F93AC22C4D|         394|                        5|                                              CPU + Wait for CPU|       0.14%|                                                            |
                                        |           0|                        4|                                                       palf read|       0.11%|                                                            |
                                        |           0|                        4|                                            db file compact read|       0.11%|                                                            |
                                        |           0|                        3|                                          default condition wait|       0.08%|                                                            |
                                        |           0|                        3|                                                        sync rpc|       0.08%|                                                            |
                                        |           0|                        2|                                        latch: ls meta lock wait|       0.06%|                                                            |
        BF3CC7901C9D3AA1C2F3920B3BEFD839|        1564|                        1|                                              CPU + Wait for CPU|       0.03%|     select "ANONYMOUS_VIEW1"."EVENT" AS "EVENT","ANONYMOUS_|
        8482C8137DA40CE77C9387299138C1E7|        1565|                        1|                                              CPU + Wait for CPU|       0.03%|     select "ANONYMOUS_VIEW2"."EXECUTION_PHASE" AS "EXECUTIO|
----------------------------------------+------------+-------------------------+----------------------------------------------------------------+------------+------------------------------------------------------------+

## Top SQL with Top Blocking Events
 - Empty result if no event other than On CPU sampled
 - Empty 'SQL Text' if it is PL/SQL query
----------------------------------------+------------+-------------------------+----------------------------------------------------------------+------------+------------------------------------------------------------+
                                  SQL ID|     PLAN ID|  Sampled # of Executions|                                                           Event|     % Event|                                                    SQL Text|
----------------------------------------+------------+-------------------------+----------------------------------------------------------------+------------+------------------------------------------------------------+
                                    NULL|           0|                      145|                                                      palf write|       4.04%|                                                            |
                                    NULL|           0|                       39|                                       slog flush condition wait|       1.09%|                                                            |
                                    NULL|           0|                       31|                                           db file compact write|       0.86%|                                                            |
                                    NULL|           0|                       13|                                  async rpc proxy condition wait|       0.36%|                                                            |
                                    NULL|           0|                        8|                               wait for network request in queue|       0.22%|                                                            |
                                    NULL|           0|                        6|                                                      sleep wait|       0.17%|                                                            |
                                    NULL|           0|                        4|                                                       palf read|       0.11%|                                                            |
                                    NULL|           0|                        4|                                            db file compact read|       0.11%|                                                            |
                                    NULL|           0|                        3|                                                        sync rpc|       0.08%|                                                            |
                                    NULL|           0|                        3|                                          default condition wait|       0.08%|                                                            |
                                    NULL|           0|                        2|                                        latch: ls meta lock wait|       0.06%|                                                            |
----------------------------------------+------------+-------------------------+----------------------------------------------------------------+------------+------------------------------------------------------------+

## Complete List of SQL Text
  SQL ID: BF3CC7901C9D3AA1C2F3920B3BEFD839
 PLAN ID: 1564
SQL Text: select "ANONYMOUS_VIEW1"."EVENT" AS "EVENT","ANONYMOUS_VIEW1"."EVENT_CNT" AS "EVENT_CNT","ANONYMOUS_VIEW1"."SAMPLE_CNT" AS "SAMPLE_CNT","ANONYMOUS_VIEW1"."P1" AS "P1","ANONYMOUS_VIEW1"."P2" AS "P2","ANONYMOUS_VIEW1"."P3" AS "P3","ANONYMOUS_VIEW1"."P1TEXT" AS "P1TEXT","ANONYMOUS_VIEW1"."P2TEXT" AS "P2TEXT","ANONYMOUS_VIEW1"."P3TEXT" AS "P3TEXT" from (select "TOP_EVENT"."EVENT" AS "EVENT",sum(1) AS "EVENT_CNT",count(1) AS "SAMPLE_CNT",max("TOP_EVENT"."P1") AS "P1",max("TOP_EVENT"."P2") AS "P2",max("TOP_EVENT"."P3") AS "P3",max("TOP_EVENT"."P1TEXT") AS "P1TEXT",max("TOP_EVENT"."P2TEXT") AS "P2TEXT",max("TOP_EVENT"."P3TEXT") AS "P3TEXT" from (select "UNIFIED_ASH"."SAMPLE_ID" AS "SAMPLE_ID","UNIFIED_ASH"."SAMPLE_TIME" AS "SAMPLE_TIME","UNIFIED_ASH"."SVR_IP" AS "SVR_IP","UNIFIED_ASH"."SVR_PORT" AS "SVR_PORT","UNIFIED_ASH"."CON_ID" AS "CON_ID","UNIFIED_ASH"."USER_ID" AS "USER_ID","UNIFIED_ASH"."SESSION_ID" AS "SESSION_ID","UNIFIED_ASH"."SESSION_TYPE" AS "SESSION_TYPE","UNIFIED_ASH"."SESSION_STATE" AS "SESSION_STATE","UNIFIED_ASH"."TOP_LEVEL_SQL_ID" AS "TOP_LEVEL_SQL_ID","UNIFIED_ASH"."SQL_ID" AS "SQL_ID","UNIFIED_ASH"."PLAN_ID" AS "PLAN_ID","UNIFIED_ASH"."TRACE_ID" AS "TRACE_ID","UNIFIED_ASH"."EVENT" AS "EVENT","UNIFIED_ASH"."EVENT_NO" AS "EVENT_NO","UNIFIED_ASH"."P1" AS "P1","UNIFIED_ASH"."P1TEXT" AS "P1TEXT","UNIFIED_ASH"."P2" AS "P2","UNIFIED_ASH"."P2TEXT" AS "P2TEXT","UNIFIED_ASH"."P3" AS "P3","UNIFIED_ASH"."P3TEXT" AS "P3TEXT","UNIFIED_ASH"."WAIT_CLASS" AS "WAIT_CLASS","UNIFIED_ASH"."WAIT_CLASS_ID" AS "WAIT_CLASS_ID","UNIFIED_ASH"."TIME_WAITED" AS "TIME_WAITED","UNIFIED_ASH"."SQL_PLAN_LINE_ID" AS "SQL_PLAN_LINE_ID","UNIFIED_ASH"."IN_PARSE" AS "IN_PARSE","UNIFIED_ASH"."IN_PL_PARSE" AS "IN_PL_PARSE","UNIFIED_ASH"."IN_PLAN_CACHE" AS "IN_PLAN_CACHE","UNIFIED_ASH"."IN_SQL_OPTIMIZE" AS "IN_SQL_OPTIMIZE","UNIFIED_ASH"."IN_SQL_EXECUTION" AS "IN_SQL_EXECUTION","UNIFIED_ASH"."IN_PX_EXECUTION" AS "IN_PX_EXECUTION","UNIFIED_ASH"."IN_SEQUENCE_LOAD" AS "IN_SEQUENCE_LOAD","UNIFIED_ASH"."IN_COMMITTING" AS "IN_COMMITTING","UNIFIED_ASH"."IN_STORAGE_READ" AS "IN_STORAGE_READ","UNIFIED_ASH"."IN_STORAGE_WRITE" AS "IN_STORAGE_WRITE","UNIFIED_ASH"."IN_REMOTE_DAS_EXECUTION" AS "IN_REMOTE_DAS_EXECUTION","UNIFIED_ASH"."IN_PLSQL_EXECUTION" AS "IN_PLSQL_EXECUTION","UNIFIED_ASH"."IN_PLSQL_COMPILATION" AS "IN_PLSQL_COMPILATION","UNIFIED_ASH"."PLSQL_ENTRY_OBJECT_ID" AS "PLSQL_ENTRY_OBJECT_ID","UNIFIED_ASH"."PLSQL_ENTRY_SUBPROGRAM_ID" AS "PLSQL_ENTRY_SUBPROGRAM_ID","UNIFIED_ASH"."PLSQL_ENTRY_SUBPROGRAM_NAME" AS "PLSQL_ENTRY_SUBPROGRAM_NAME","UNIFIED_ASH"."PLSQL_OBJECT_ID" AS "PLSQL_OBJECT_ID","UNIFIED_ASH"."PLSQL_SUBPROGRAM_ID" AS "PLSQL_SUBPROGRAM_ID","UNIFIED_ASH"."PLSQL_SUBPROGRAM_NAME" AS "PLSQL_SUBPROGRAM_NAME","UNIFIED_ASH"."MODULE" AS "MODULE","UNIFIED_ASH"."ACTION" AS "ACTION","UNIFIED_ASH"."CLIENT_ID" AS "CLIENT_ID" from (select "SYS"."A"."SAMPLE_ID" AS "SAMPLE_ID","SYS"."A"."SAMPLE_TIME" AS "SAMPLE_TIME","SYS"."A"."SVR_IP" AS "SVR_IP","SYS"."A"."SVR_PORT" AS "SVR_PORT","SYS"."A"."CON_ID" AS "CON_ID","SYS"."A"."USER_ID" AS "USER_ID","SYS"."A"."SESSION_ID" AS "SESSION_ID","SYS"."A"."SESSION_TYPE" AS "SESSION_TYPE","SYS"."A"."SESSION_STATE" AS "SESSION_STATE","SYS"."A"."TOP_LEVEL_SQL_ID" AS "TOP_LEVEL_SQL_ID","SYS"."A"."SQL_ID" AS "SQL_ID","SYS"."A"."PLAN_ID" AS "PLAN_ID","SYS"."A"."TRACE_ID" AS "TRACE_ID",NVL("SYS"."A"."EVENT",'CPU + Wait for CPU') AS "EVENT",NVL("SYS"."A"."EVENT_NO",1) AS "EVENT_NO","SYS"."A"."P1" AS "P1","SYS"."A"."P1TEXT" AS "P1TEXT","SYS"."A"."P2" AS "P2","SYS"."A"."P2TEXT" AS "P2TEXT","SYS"."A"."P3" AS "P3","SYS"."A"."P3TEXT" AS "P3TEXT",NVL("SYS"."A"."WAIT_CLASS",'CPU') AS "WAIT_CLASS",NVL("SYS"."A"."WAIT_CLASS_ID",9999) AS "WAIT_CLASS_ID","SYS"."A"."TIME_WAITED" AS "TIME_WAITED","SYS"."A"."SQL_PLAN_LINE_ID" AS "SQL_PLAN_LINE_ID","SYS"."A"."IN_PARSE" AS "IN_PARSE","SYS"."A"."IN_PL_PARSE" AS "IN_PL_PARSE","SYS"."A"."IN_PLAN_CACHE" AS "IN_PLAN_CACHE","SYS"."A"."IN_SQL_OPTIMIZE" AS "IN_SQL_OPTIMIZE","SYS"."A"."IN_SQL_EXECUTION" AS "
  SQL ID: 8482C8137DA40CE77C9387299138C1E7
 PLAN ID: 1565
SQL Text: select "ANONYMOUS_VIEW2"."EXECUTION_PHASE" AS "EXECUTION_PHASE","ANONYMOUS_VIEW2"."SAMPLES_CNT" AS "SAMPLES_CNT" from (select /*+ NO_REWRITE */ *  FROM (select sum((case "TOP_EVENT"."IN_PARSE" when 'N' then 0 else 1 end)) AS "IN_PARSE",sum((case "TOP_EVENT"."IN_PL_PARSE" when 'N' then 0 else 1 end)) AS "IN_PL_PARSE",sum((case "TOP_EVENT"."IN_PLAN_CACHE" when 'N' then 0 else 1 end)) AS "IN_PLAN_CACHE",sum((case "TOP_EVENT"."IN_SQL_OPTIMIZE" when 'N' then 0 else 1 end)) AS "IN_SQL_OPTIMIZE",sum((case "TOP_EVENT"."IN_SQL_EXECUTION" when 'N' then 0 else 1 end)) AS "IN_SQL_EXECUTION",sum((case "TOP_EVENT"."IN_PX_EXECUTION" when 'N' then 0 else 1 end)) AS "IN_PX_EXECUTION",sum((case "TOP_EVENT"."IN_SEQUENCE_LOAD" when 'N' then 0 else 1 end)) AS "IN_SEQUENCE_LOAD",sum((case "TOP_EVENT"."IN_COMMITTING" when 'N' then 0 else 1 end)) AS "IN_COMMITTING",sum((case "TOP_EVENT"."IN_STORAGE_READ" when 'N' then 0 else 1 end)) AS "IN_STORAGE_READ",sum((case "TOP_EVENT"."IN_STORAGE_WRITE" when 'N' then 0 else 1 end)) AS "IN_STORAGE_WRITE",sum((case "TOP_EVENT"."IN_REMOTE_DAS_EXECUTION" when 'N' then 0 else 1 end)) AS "IN_REMOTE_DAS_EXECUTION" from (select "UNIFIED_ASH"."SAMPLE_ID" AS "SAMPLE_ID","UNIFIED_ASH"."SAMPLE_TIME" AS "SAMPLE_TIME","UNIFIED_ASH"."SVR_IP" AS "SVR_IP","UNIFIED_ASH"."SVR_PORT" AS "SVR_PORT","UNIFIED_ASH"."CON_ID" AS "CON_ID","UNIFIED_ASH"."USER_ID" AS "USER_ID","UNIFIED_ASH"."SESSION_ID" AS "SESSION_ID","UNIFIED_ASH"."SESSION_TYPE" AS "SESSION_TYPE","UNIFIED_ASH"."SESSION_STATE" AS "SESSION_STATE","UNIFIED_ASH"."TOP_LEVEL_SQL_ID" AS "TOP_LEVEL_SQL_ID","UNIFIED_ASH"."SQL_ID" AS "SQL_ID","UNIFIED_ASH"."PLAN_ID" AS "PLAN_ID","UNIFIED_ASH"."TRACE_ID" AS "TRACE_ID","UNIFIED_ASH"."EVENT" AS "EVENT","UNIFIED_ASH"."EVENT_NO" AS "EVENT_NO","UNIFIED_ASH"."P1" AS "P1","UNIFIED_ASH"."P1TEXT" AS "P1TEXT","UNIFIED_ASH"."P2" AS "P2","UNIFIED_ASH"."P2TEXT" AS "P2TEXT","UNIFIED_ASH"."P3" AS "P3","UNIFIED_ASH"."P3TEXT" AS "P3TEXT","UNIFIED_ASH"."WAIT_CLASS" AS "WAIT_CLASS","UNIFIED_ASH"."WAIT_CLASS_ID" AS "WAIT_CLASS_ID","UNIFIED_ASH"."TIME_WAITED" AS "TIME_WAITED","UNIFIED_ASH"."SQL_PLAN_LINE_ID" AS "SQL_PLAN_LINE_ID","UNIFIED_ASH"."IN_PARSE" AS "IN_PARSE","UNIFIED_ASH"."IN_PL_PARSE" AS "IN_PL_PARSE","UNIFIED_ASH"."IN_PLAN_CACHE" AS "IN_PLAN_CACHE","UNIFIED_ASH"."IN_SQL_OPTIMIZE" AS "IN_SQL_OPTIMIZE","UNIFIED_ASH"."IN_SQL_EXECUTION" AS "IN_SQL_EXECUTION","UNIFIED_ASH"."IN_PX_EXECUTION" AS "IN_PX_EXECUTION","UNIFIED_ASH"."IN_SEQUENCE_LOAD" AS "IN_SEQUENCE_LOAD","UNIFIED_ASH"."IN_COMMITTING" AS "IN_COMMITTING","UNIFIED_ASH"."IN_STORAGE_READ" AS "IN_STORAGE_READ","UNIFIED_ASH"."IN_STORAGE_WRITE" AS "IN_STORAGE_WRITE","UNIFIED_ASH"."IN_REMOTE_DAS_EXECUTION" AS "IN_REMOTE_DAS_EXECUTION","UNIFIED_ASH"."IN_PLSQL_EXECUTION" AS "IN_PLSQL_EXECUTION","UNIFIED_ASH"."IN_PLSQL_COMPILATION" AS "IN_PLSQL_COMPILATION","UNIFIED_ASH"."PLSQL_ENTRY_OBJECT_ID" AS "PLSQL_ENTRY_OBJECT_ID","UNIFIED_ASH"."PLSQL_ENTRY_SUBPROGRAM_ID" AS "PLSQL_ENTRY_SUBPROGRAM_ID","UNIFIED_ASH"."PLSQL_ENTRY_SUBPROGRAM_NAME" AS "PLSQL_ENTRY_SUBPROGRAM_NAME","UNIFIED_ASH"."PLSQL_OBJECT_ID" AS "PLSQL_OBJECT_ID","UNIFIED_ASH"."PLSQL_SUBPROGRAM_ID" AS "PLSQL_SUBPROGRAM_ID","UNIFIED_ASH"."PLSQL_SUBPROGRAM_NAME" AS "PLSQL_SUBPROGRAM_NAME","UNIFIED_ASH"."MODULE" AS "MODULE","UNIFIED_ASH"."ACTION" AS "ACTION","UNIFIED_ASH"."CLIENT_ID" AS "CLIENT_ID" from (select "SYS"."A"."SAMPLE_ID" AS "SAMPLE_ID","SYS"."A"."SAMPLE_TIME" AS "SAMPLE_TIME","SYS"."A"."SVR_IP" AS "SVR_IP","SYS"."A"."SVR_PORT" AS "SVR_PORT","SYS"."A"."CON_ID" AS "CON_ID","SYS"."A"."USER_ID" AS "USER_ID","SYS"."A"."SESSION_ID" AS "SESSION_ID","SYS"."A"."SESSION_TYPE" AS "SESSION_TYPE","SYS"."A"."SESSION_STATE" AS "SESSION_STATE","SYS"."A"."TOP_LEVEL_SQL_ID" AS "TOP_LEVEL_SQL_ID","SYS"."A"."SQL_ID" AS "SQL_ID","SYS"."A"."PLAN_ID" AS "PLAN_ID","SYS"."A"."TRACE_ID" AS "TRACE_ID",NVL("SYS"."A"."EVENT",'CPU + Wait for CPU') AS "EVENT",NVL("SYS"."A"."EVENT_NO",1) AS "EVENT_NO","SYS"."A"."P1" AS "P1","SYS"."A"."P1TEXT" AS "P1TEXT","SYS"."

## Top PL/SQL Procedures
-> 'PL/SQL entry subprogram' represents the application's top-level
      entry-point(procedure, function, trigger, package initialization) into PL/SQL.
-> 'PL/SQL current subprogram' is the pl/sql subprogram being executed
      at the point of sampling . If the value is 'SQL', it represents
           the percentage of time spent executing SQL for the particular
      plsql entry subprogram
-> 'PL/SQL entry subprogram' represents the application's top-level
------------------------------------------------------------+------------------------------------------------------------+--------------------+
                                      PLSQL Entry Subprogram|                                    PLSQL Current Subprogram|          % Activity|
------------------------------------------------------------+------------------------------------------------------------+--------------------+
                                  oceanbase.__all_core_table|                                                          --|               0.28%|
------------------------------------------------------------+------------------------------------------------------------+--------------------+

## Top Sessions:
 - '# Samples Active' shows the number of ASH samples in which the session was found waiting for that particular event. The percentage shown in this column is calculated with respect to wall time.
--------------------+----------------------+----------------------------------------------------------------+------------+------------+--------------------+--------------------+
                 Sid|            % Activity|                                                           Event| Event Count|     % Event|                User|    # Samples Active|
--------------------+----------------------+----------------------------------------------------------------+------------+------------+--------------------+--------------------+
       5334349381632|                32.94%|                                              CPU + Wait for CPU|        1181|      32.94%|                    |   1181/59675[1.98%]|
       5226975199232|                 8.79%|                                              CPU + Wait for CPU|         315|       8.79%|                    |    315/59675[0.53%]|
       5295694675968|                 7.09%|                                              CPU + Wait for CPU|         254|       7.09%|                    |    254/59675[0.43%]|
       4793183502336|                 4.66%|                                              CPU + Wait for CPU|         167|       4.66%|                    |    167/59675[0.28%]|
       6279242186752|                 3.43%|                                              CPU + Wait for CPU|         123|       3.43%|                    |    123/59675[0.21%]|
       6283537154048|                 3.26%|                                              CPU + Wait for CPU|         117|       3.26%|                    |    117/59675[0.20%]|
       5368709120000|                 2.26%|                                              CPU + Wait for CPU|          81|       2.26%|                    |     81/59675[0.14%]|
       4720169058304|                 2.20%|                                                      palf write|          79|       2.20%|                    |     79/59675[0.13%]|
       5214090297344|                 2.12%|                                              CPU + Wait for CPU|          76|       2.12%|                    |     76/59675[0.13%]|
       4784593567744|                 2.09%|                                              CPU + Wait for CPU|          75|       2.09%|                    |     75/59675[0.13%]|
       4724464025600|                 1.84%|                                                      palf write|          66|       1.84%|                    |     66/59675[0.11%]|
       5085241278464|                 1.42%|                                              CPU + Wait for CPU|          51|       1.42%|                    |     51/59675[0.09%]|
       4840428142592|                 1.42%|                                              CPU + Wait for CPU|          51|       1.42%|                    |     51/59675[0.09%]|
       4797478469632|                 1.31%|                                              CPU + Wait for CPU|          47|       1.31%|                    |     47/59675[0.08%]|
       4690104287232|                 1.20%|                                              CPU + Wait for CPU|          43|       1.20%|                    |     43/59675[0.07%]|
       4715874091008|                 1.20%|                                              CPU + Wait for CPU|          43|       1.20%|                    |     43/59675[0.07%]|
       5244155068416|                 1.12%|                                              CPU + Wait for CPU|          40|       1.12%|                    |     40/59675[0.07%]|
       5115306049536|                 1.12%|                                              CPU + Wait for CPU|          40|       1.12%|                    |     40/59675[0.07%]|
       4771708665856|                 1.12%|                                              CPU + Wait for CPU|          40|       1.12%|                    |     40/59675[0.07%]|
--------------------+----------------------+----------------------------------------------------------------+------------+------------+--------------------+--------------------+

## Top Blocking Sessions:
 - Blocking session activity percentages are calculated with respect to waits on latches and locks only.
 - '# Samples Active' shows the number of ASH samples in which the blocking session was found active.
--------------------+----------------------+----------------------------------------+------------+------------+--------------------+--------------------+
        Blocking Sid|            % Activity|                            Event Caused| Event Count|     % Event|                User|    # Samples Active|
--------------------+----------------------+----------------------------------------+------------+------------+--------------------+--------------------+
       4720169058304|                 2.20%|                              palf write|          79|       2.20%|                    |     79/59675[0.13%]|
       4724464025600|                 1.84%|                              palf write|          66|       1.84%|                    |     66/59675[0.11%]|
       5158255722496|                 0.86%|                   db file compact write|          31|       0.86%|                    |     31/59675[0.05%]|
       4784593567744|                 0.84%|               slog flush condition wait|          30|       0.84%|                    |     30/59675[0.05%]|
       4771708665856|                 0.36%|          async rpc proxy condition wait|          13|       0.36%|                    |     13/59675[0.02%]|
                   0|                 0.22%|       wait for network request in queue|           8|       0.22%|                    |      8/59675[0.01%]|
       5299989643264|                 0.22%|               slog flush condition wait|           8|       0.22%|                    |      8/59675[0.01%]|
       5312874545152|                 0.14%|                              sleep wait|           5|       0.14%|                    |      5/59675[0.01%]|
       5299989643264|                 0.11%|                               palf read|           4|       0.11%|                    |      4/59675[0.01%]|
       5471788335104|                 0.08%|                                sync rpc|           3|       0.08%|                    |      3/59675[0.01%]|
       5106716114944|                 0.06%|                  default condition wait|           2|       0.06%|                    |      2/59675[0.00%]|
       5308579577856|                 0.06%|                latch: ls meta lock wait|           2|       0.06%|                    |      2/59675[0.00%]|
       5351529250816|                 0.06%|                    db file compact read|           2|       0.06%|                    |      2/59675[0.00%]|
       4986457030656|                 0.03%|                    db file compact read|           1|       0.03%|                    |      1/59675[0.00%]|
        176093659136|                 0.03%|                  default condition wait|           1|       0.03%|                    |      1/59675[0.00%]|
       4969277161472|                 0.03%|               slog flush condition wait|           1|       0.03%|                    |      1/59675[0.00%]|
       5381594021888|                 0.03%|                              sleep wait|           1|       0.03%|                    |      1/59675[0.00%]|
       4930622455808|                 0.03%|                    db file compact read|           1|       0.03%|                    |      1/59675[0.00%]|
--------------------+----------------------+----------------------------------------+------------+------------+--------------------+--------------------+

## Top latches:
----------------------------------------------------------------+--------------------+--------------------+
                                                           Latch|       Sampled Count|          % Activity|
----------------------------------------------------------------+--------------------+--------------------+
                                        latch: ls meta lock wait|                   2|               0.06%|
----------------------------------------------------------------+--------------------+--------------------+

## Node Load:
----------------------------------------+--------------------+--------------------+--------------------+------------------------------+
                                  SVR IP|            SVR PORT|       Sampled Count|     Idle Wait Count|                          Load|
----------------------------------------+--------------------+--------------------+--------------------+------------------------------+
                          172.30.xxx.xxx|                28xx|                3585|                   6|                          0.06|
----------------------------------------+--------------------+--------------------+--------------------+------------------------------+
```