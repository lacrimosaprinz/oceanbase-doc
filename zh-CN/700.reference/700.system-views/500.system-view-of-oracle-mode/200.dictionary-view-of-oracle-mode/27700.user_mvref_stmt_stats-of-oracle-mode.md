|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|Oracle Mode |

# USER_MVREF_STMT_STATS

<main id="notice" type='explain'>
<h4>说明</h4>
<p>该视图从 V4.3.0 版本开始引入。</p>
</main>

## 功能说明

视图 `USER_MVREF_STMT_STATS` 用于描述刷新语句关联的信息。

## 字段说明

| **字段名称** | **类型** | **是否可以为 NULL** | **描述** |
| --- | --- | --- | --- |
| MV_OWNER | VARCHAR2(128) | YES | 物化视图所有者名称 |
| MV_NAME | VARCHAR2(128) | YES | 物化视图名称 |
| REFRESH_ID | NUMBER | NO | 刷新 ID |
| STEP | NUMBER | NO | 步骤编号，从1开始连续编号 |
| SQLID | VARCHAR2(14) | YES | SQL ID |
| STMT | CLOB | NO | SQL 文本 |
| EXECUTION_TIME | NUMBER | NO | SQL 执行时间，单位为秒 |
| EXECUTION_PLAN | CLOB | YES | 仅限内部人员排查问题使用<main id="notice" type='explain'> <h4>说明</h4><p>该字段仅兼容，且值默认为 NULL。</p></main> |

## 查询示例

```shell
obclient [SYS]> SELECT * FROM SYS.USER_MVREF_STMT_STATS;
```

查询结果如下：

```shell
+----------+---------+------------+------+----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+----------------+
| MV_OWNER | MV_NAME | REFRESH_ID | STEP | SQLID          | STMT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | EXECUTION_TIME | EXECUTION_PLAN |
+----------+---------+------------+------+----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+----------------+
| SYS      | T1_MV1  |    1409121 |    1 | DA98E3A3F4383E | merge into "SYS"."T1_MV1" using (select "DLT_T$$"."C2" AS "C2",sum("DLT_T$$"."DMLFACTOR$$") AS "CNT",sum(("DLT_T$$"."DMLFACTOR$$" * (case when ("DLT_T$$"."C3" is null) then 0 else 1 end))) AS "CNT_C3",sum(("DLT_T$$"."DMLFACTOR$$" * "DLT_T$$"."C3")) AS "SUM_C3" from (select "MLOG$_T1"."OLD_NEW$$" AS "OLD_NEW$$","MLOG$_T1"."SEQUENCE$$" AS "SEQUENCE$$",(case when ("MLOG$_T1"."OLD_NEW$$" = 'N') then 1 else -1 end) AS "DMLFACTOR$$",max("MLOG$_T1"."SEQUENCE$$") over( PARTITION BY "MLOG$_T1"."C1") AS "MAXSEQ$$",min("MLOG$_T1"."SEQUENCE$$") over( PARTITION BY "MLOG$_T1"."C1") AS "MINSEQ$$","MLOG$_T1"."C2" AS "C2","MLOG$_T1"."C3" AS "C3" from "SYS"."MLOG$_T1" where ("MLOG$_T1"."ORA_ROWSCN" > 1706148205539021229) and ("MLOG$_T1"."ORA_ROWSCN" <= 1706148239301769113)) "DLT_T$$" where ((("DLT_T$$"."OLD_NEW$$" = 'N') and ("DLT_T$$"."SEQUENCE$$" = "DLT_T$$"."MAXSEQ$$")) or (("DLT_T$$"."OLD_NEW$$" = 'O') and ("DLT_T$$"."SEQUENCE$$" = "DLT_T$$"."MINSEQ$$"))) group by "DLT_T$$"."C2") "DLT_BASIC_MV$$" on ( ("T1_MV1"."C2" <=> "DLT_BASIC_MV$$"."C2") ) when matched then update set "T1_MV1"."CNT" = ("T1_MV1"."CNT" + "DLT_BASIC_MV$$"."CNT"), "T1_MV1"."CNT_C3" = ("T1_MV1"."CNT_C3" + "DLT_BASIC_MV$$"."CNT_C3"), "T1_MV1"."SUM_C3" = (case when (("T1_MV1"."CNT_C3" + "DLT_BASIC_MV$$"."CNT_C3") = 0) then NULL when ("T1_MV1"."CNT_C3" = 0) then "DLT_BASIC_MV$$"."SUM_C3" when ("DLT_BASIC_MV$$"."CNT_C3" = 0) then "T1_MV1"."SUM_C3" else ("T1_MV1"."SUM_C3" + "DLT_BASIC_MV$$"."SUM_C3") end) delete where ("T1_MV1"."CNT" = 0) when not matched then insert ( C2 , CNT , CNT_C3 , SUM_C3 ) values ( "DLT_BASIC_MV$$"."C2" , "DLT_BASIC_MV$$"."CNT" , "DLT_BASIC_MV$$"."CNT_C3" , (case when ("DLT_BASIC_MV$$"."CNT_C3" = 0) then NULL else "DLT_BASIC_MV$$"."SUM_C3" end) ) where ("DLT_BASIC_MV$$"."CNT" <> 0) |              0 | NULL           |
+----------+---------+------------+------+----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+----------------+
```
